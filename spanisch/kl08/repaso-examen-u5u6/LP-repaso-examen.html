<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repaso: Examen Unidad 5+6 | Spanisch Klasse 8</title>
    <style>
        :root {
            --bg: #f5f5f5;
            --white: #ffffff;
            --border: #dddddd;
            --text-primary: #222222;
            --text-secondary: #555555;
            --text-muted: #888888;
            --spanisch: #c41e3a;
            --spanisch-light: #f8e8eb;
            --success: #2a7a4b;
            --success-light: #e8f5e9;
            --warning: #b35c00;
            --warning-light: #fff3e0;
            --error: #c62828;
            --error-light: #ffebee;
            --info: #1565c0;
            --info-light: #e3f2fd;
        }

        * { box-sizing: border-box; }

        button, .station-btn, .mc-option, .match-card, .fc-btn, .flashcard, .drag-item, .drop-zone {
            -webkit-tap-highlight-color: rgba(196, 30, 58, 0.2);
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-size: 0.9em;
            line-height: 1.5;
            color: var(--text-primary);
            background: var(--bg);
            margin: 0;
            padding: 20px;
        }

        .container { max-width: 950px; margin: 0 auto; }

        header {
            background: var(--spanisch);
            color: white;
            padding: 15px 20px;
            margin-bottom: 20px;
        }

        header h1 { margin: 0; font-size: 1.4em; font-weight: 600; }
        header .meta { font-size: 0.85em; opacity: 0.9; margin-top: 4px; }

        /* Accent Keyboard Info */
        .accent-keyboard {
            background: var(--info-light);
            border: 1px solid var(--info);
            padding: 12px 15px;
            margin-bottom: 15px;
            font-size: 0.9em;
        }

        .lernziele {
            background: var(--white);
            border: 1px solid var(--border);
            padding: 15px;
            margin-bottom: 20px;
        }

        .lernziele h2 { font-size: 0.95em; margin: 0 0 8px 0; color: var(--spanisch); }
        .lernziele ul { margin: 0; padding-left: 20px; }

        .station-nav {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        @media (min-width: 700px) {
            .station-nav { grid-template-columns: repeat(10, 1fr); }
        }

        .station-btn {
            background: var(--white);
            border: 2px solid var(--border);
            padding: 10px 4px;
            min-height: 60px;
            text-align: center;
            cursor: pointer;
            font-size: 0.75em;
        }

        .station-btn:hover, .station-btn:active { border-color: var(--spanisch); }
        .station-btn.active { border-color: var(--spanisch); background: var(--spanisch-light); }
        .station-btn.completed { border-color: var(--success); background: var(--success-light); }
        .station-btn .number { font-weight: 600; font-size: 1.1em; color: var(--spanisch); }
        .station-btn .title { font-size: 0.7em; color: var(--text-muted); margin-top: 2px; }

        .station {
            background: var(--white);
            border: 1px solid var(--border);
            padding: 20px;
            margin-bottom: 15px;
            display: none;
        }

        .station.active { display: block; }

        .station-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--spanisch);
        }

        .station-number {
            background: var(--spanisch);
            color: white;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1em;
            flex-shrink: 0;
        }

        .station-title { font-weight: 600; font-size: 1.1em; }

        .es { font-family: Georgia, "Times New Roman", serif; font-weight: 600; }
        .de { color: var(--text-muted); font-style: italic; font-size: 0.9em; }

        .grammar-box {
            background: var(--bg);
            border-left: 3px solid var(--spanisch);
            padding: 12px 15px;
            margin: 15px 0;
        }

        .grammar-box h3 { font-size: 0.95em; margin: 0 0 10px 0; color: var(--spanisch); }

        .conj-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            margin: 10px 0;
        }

        .conj-table th, .conj-table td {
            padding: 8px 10px;
            border: 1px solid var(--border);
            text-align: left;
        }

        .conj-table th {
            background: var(--spanisch);
            color: white;
            font-weight: 600;
        }

        .conj-table .pronoun { font-weight: 600; background: #f9f9f9; }
        .conj-table .ending { color: var(--spanisch); font-weight: 600; }

        .tip {
            background: var(--info-light);
            border-left: 3px solid var(--info);
            padding: 10px 15px;
            margin: 15px 0;
            font-size: 0.9em;
        }

        .exercise {
            background: var(--bg);
            border: 1px solid var(--border);
            padding: 15px;
            margin: 15px 0;
        }

        .exercise h3 { font-size: 0.95em; margin: 0 0 12px 0; color: var(--spanisch); }

        .question { margin-bottom: 12px; }

        input[type="text"] {
            border: none;
            border-bottom: 2px solid var(--spanisch);
            padding: 4px 8px;
            font-size: inherit;
            font-family: inherit;
            background: transparent;
            width: 120px;
        }

        input[type="text"]:focus { outline: none; border-bottom-color: var(--text-primary); }
        input[type="text"].correct { border-bottom-color: var(--success); color: var(--success); background: var(--success-light); }
        input[type="text"].incorrect { border-bottom-color: var(--error); color: var(--error); background: var(--error-light); }

        .check-btn, .reset-btn {
            background: var(--spanisch);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 0.9em;
            cursor: pointer;
            margin-top: 10px;
            min-height: 48px;
        }

        .check-btn:hover, .reset-btn:hover { opacity: 0.9; }

        .reset-btn {
            background: var(--text-muted);
            margin-left: 10px;
        }

        .next-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 0.9em;
            cursor: pointer;
            margin-top: 15px;
            float: right;
            min-height: 48px;
        }

        .feedback {
            padding: 10px 15px;
            margin-top: 15px;
            font-size: 0.9em;
            clear: both;
        }

        .feedback.success { background: var(--success-light); border: 1px solid var(--success); color: var(--success); }
        .feedback.error { background: var(--error-light); border: 1px solid var(--error); color: var(--error); }

        /* Audio button */
        .audio-btn {
            background: var(--info);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.1em;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
            margin-left: 8px;
        }

        .audio-btn:active { transform: scale(0.9); }
        .audio-btn.playing { background: var(--spanisch); animation: pulse 1s infinite; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* Memory Game */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .memory-card {
            aspect-ratio: 1;
            background: var(--spanisch);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85em;
            color: white;
            padding: 8px;
            text-align: center;
            min-height: 70px;
            transition: transform 0.3s;
        }

        .memory-card.flipped {
            background: var(--white);
            color: var(--text-primary);
            border: 2px solid var(--spanisch);
        }

        .memory-card.matched {
            background: var(--success-light);
            color: var(--success);
            border: 2px solid var(--success);
            cursor: default;
        }

        .memory-card .card-back { display: block; }
        .memory-card .card-front { display: none; }
        .memory-card.flipped .card-back { display: none; }
        .memory-card.flipped .card-front { display: block; }
        .memory-card.matched .card-back { display: none; }
        .memory-card.matched .card-front { display: block; }

        /* Flashcards with swipe */
        .flashcard-area {
            perspective: 1000px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            touch-action: pan-y;
        }

        .flashcard {
            width: 100%;
            height: 200px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            cursor: pointer;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .flashcard.flipped { transform: rotateY(180deg); }

        .flashcard.swipe-right {
            transition: transform 0.3s ease-out;
            transform: translateX(120%) rotate(15deg);
            opacity: 0;
        }
        .flashcard.swipe-left {
            transition: transform 0.3s ease-out;
            transform: translateX(-120%) rotate(-15deg);
            opacity: 0;
        }

        .swipe-indicator {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 3em;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
            z-index: 10;
        }

        .swipe-indicator.left { left: 20px; color: var(--error); }
        .swipe-indicator.right { right: 20px; color: var(--success); }

        .flashcard-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
        }

        .flashcard-front {
            background: var(--spanisch);
            color: white;
        }

        .flashcard-back {
            transform: rotateY(180deg);
            background: var(--white);
        }

        .flashcard-word { font-size: 1.5em; font-weight: 600; text-align: center; }
        .flashcard-hint { font-size: 0.85em; margin-top: 8px; opacity: 0.8; }

        .fc-controls {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 15px;
        }

        .fc-btn {
            flex: 1;
            padding: 15px;
            border: none;
            font-size: 1em;
            cursor: pointer;
            min-height: 52px;
        }

        .fc-btn.wrong { background: var(--error-light); color: var(--error); border: 2px solid var(--error); }
        .fc-btn.correct { background: var(--success-light); color: var(--success); border: 2px solid var(--success); }

        .fc-progress {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9em;
            color: var(--text-muted);
        }

        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            margin-top: 8px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s;
        }

        /* Match Game */
        .match-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }

        .match-column h4 {
            font-size: 0.9em;
            color: var(--spanisch);
            margin: 0 0 10px 0;
        }

        .match-card {
            background: var(--white);
            border: 2px solid var(--border);
            padding: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            min-height: 48px;
            display: flex;
            align-items: center;
        }

        .match-card:hover { border-color: var(--spanisch); }
        .match-card.selected { border-color: var(--spanisch); background: var(--spanisch-light); }
        .match-card.matched { border-color: var(--success); background: var(--success-light); color: var(--success); cursor: default; }

        /* Multiple Choice */
        .mc-options { display: flex; flex-direction: column; gap: 8px; margin: 10px 0; }

        .mc-option {
            background: var(--white);
            border: 2px solid var(--border);
            padding: 12px 16px;
            cursor: pointer;
            min-height: 48px;
            display: flex;
            align-items: center;
        }

        .mc-option:hover { border-color: var(--spanisch); }
        .mc-option.selected { border-color: var(--spanisch); background: var(--spanisch-light); }
        .mc-option.correct { border-color: var(--success); background: var(--success-light); }
        .mc-option.incorrect { border-color: var(--error); background: var(--error-light); }

        /* Drag and Drop */
        .drag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            min-height: 60px;
            padding: 15px;
            background: var(--bg);
            border: 2px dashed var(--border);
            border-radius: 8px;
        }

        .drag-item {
            background: var(--spanisch);
            color: white;
            padding: 10px 16px;
            cursor: grab;
            font-size: 0.95em;
            min-height: 44px;
            display: flex;
            align-items: center;
            border-radius: 4px;
            touch-action: none;
        }

        .drag-item:active { cursor: grabbing; opacity: 0.8; }
        .drag-item.dragging { opacity: 0.5; }

        .drop-zone {
            border: 2px dashed var(--spanisch);
            padding: 15px;
            min-height: 60px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
            border-radius: 8px;
            background: var(--white);
        }

        .drop-zone.hover { background: var(--spanisch-light); border-style: solid; }
        .drop-zone .drag-item { background: var(--info); cursor: pointer; }
        .drop-zone.correct { border-color: var(--success); background: var(--success-light); }
        .drop-zone.incorrect { border-color: var(--error); background: var(--error-light); }

        .drop-zone-label {
            color: var(--text-muted);
            font-size: 0.85em;
            width: 100%;
        }

        /* Timer game */
        .timer-display {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
            color: var(--spanisch);
            margin: 15px 0;
        }

        .timer-display.warning { color: var(--warning); }
        .timer-display.danger { color: var(--error); animation: blink 0.5s infinite; }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .speed-round {
            background: var(--white);
            border: 2px solid var(--spanisch);
            padding: 20px;
            text-align: center;
            margin: 15px 0;
        }

        .speed-prompt {
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .speed-input {
            font-size: 1.2em;
            padding: 12px 20px;
            width: 200px;
            text-align: center;
            border: 2px solid var(--border);
            border-radius: 8px;
        }

        .speed-input:focus {
            outline: none;
            border-color: var(--spanisch);
        }

        /* Score display */
        .score-display {
            background: var(--info-light);
            border: 1px solid var(--info);
            padding: 10px 15px;
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
        }

        /* Completion */
        .completion {
            text-align: center;
            padding: 30px;
        }

        .completion h2 { color: var(--success); margin-bottom: 15px; }

        .final-score {
            font-size: 2em;
            font-weight: bold;
            color: var(--spanisch);
            margin: 20px 0;
        }

        /* Sentence builder */
        .sentence-target {
            background: var(--bg);
            padding: 15px;
            margin: 15px 0;
            font-size: 1.1em;
            border-left: 3px solid var(--spanisch);
        }

        .sentence-result {
            min-height: 60px;
            background: var(--white);
            border: 2px solid var(--border);
            padding: 15px;
            margin: 10px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Repaso: Examen Unidad 5 + 6</h1>
            <div class="meta">Klasse 8 | Spanisch | Wiederholung</div>
        </header>

        <div class="lernziele">
            <h2>Lernziele dieser Wiederholung</h2>
            <ul>
                <li>Modalverben (querer, poder, tener que) sicher konjugieren und anwenden</li>
                <li>Das presente continuo (estar + gerundio) bilden und verwenden</li>
                <li>Kleidung und Farben mit korrekter Adjektivanpassung beschreiben</li>
                <li>Wetter auf Spanisch ausdr√ºcken</li>
                <li>Ortspr√§positionen richtig verwenden</li>
                <li>Fotos strukturiert beschreiben</li>
            </ul>
        </div>

        <nav class="station-nav">
            <button class="station-btn active" onclick="showStation(1)">
                <div class="number">1</div>
                <div class="title">Modalverben</div>
            </button>
            <button class="station-btn" onclick="showStation(2)">
                <div class="number">2</div>
                <div class="title">Continuo</div>
            </button>
            <button class="station-btn" onclick="showStation(3)">
                <div class="number">3</div>
                <div class="title">Ropa</div>
            </button>
            <button class="station-btn" onclick="showStation(4)">
                <div class="number">4</div>
                <div class="title">Tiempo</div>
            </button>
            <button class="station-btn" onclick="showStation(5)">
                <div class="number">5</div>
                <div class="title">Lugar</div>
            </button>
            <button class="station-btn" onclick="showStation(6)">
                <div class="number">6</div>
                <div class="title">Flashcards</div>
            </button>
            <button class="station-btn" onclick="showStation(7)">
                <div class="number">7</div>
                <div class="title">Memory</div>
            </button>
            <button class="station-btn" onclick="showStation(8)">
                <div class="number">8</div>
                <div class="title">Speed-Drill</div>
            </button>
            <button class="station-btn" onclick="showStation(9)">
                <div class="number">9</div>
                <div class="title">Foto</div>
            </button>
            <button class="station-btn" onclick="showStation(10)">
                <div class="number">10</div>
                <div class="title">Test</div>
            </button>
        </nav>

        <!-- Station 1: Verbos Modales -->
        <section class="station active" id="station-1">
            <div class="station-header">
                <div class="station-number">1</div>
                <div class="station-title">Los verbos modales</div>
            </div>

            <div class="accent-keyboard">
                <strong>So schreibst du Akzente auf dem iPad:</strong>
                <div style="margin: 12px 0; padding: 12px; background: #fff; border: 2px solid var(--spanisch); border-radius: 8px;">
                    <p style="margin: 0 0 10px 0;">Halte den Buchstaben <strong>gedr√ºckt</strong> ‚Äì es erscheint ein Popup:</p>
                    <div style="background: #d1d5db; padding: 10px; border-radius: 8px; text-align: center;">
                        <div style="display: inline-block; background: #fff; border-radius: 6px; padding: 6px 4px; margin-bottom: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
                            <span style="display: inline-block; width: 28px; height: 32px; background: #f3f4f6; border-radius: 4px; line-height: 32px; margin: 0 1px;">√†</span>
                            <span style="display: inline-block; width: 28px; height: 32px; background: var(--spanisch); color: white; border-radius: 4px; line-height: 32px; font-weight: bold; margin: 0 1px;">√°</span>
                            <span style="display: inline-block; width: 28px; height: 32px; background: #f3f4f6; border-radius: 4px; line-height: 32px; margin: 0 1px;">√¢</span>
                            <span style="display: inline-block; width: 28px; height: 32px; background: #f3f4f6; border-radius: 4px; line-height: 32px; margin: 0 1px;">√§</span>
                        </div>
                        <div style="display: flex; justify-content: center; gap: 3px;">
                            <span style="width: 26px; height: 34px; background: #fff; border-radius: 4px; line-height: 34px; box-shadow: 0 1px 2px rgba(0,0,0,0.15);">q</span>
                            <span style="width: 26px; height: 34px; background: #fff; border-radius: 4px; line-height: 34px; box-shadow: 0 1px 2px rgba(0,0,0,0.15);">w</span>
                            <span style="width: 26px; height: 34px; background: var(--spanisch); color: white; border-radius: 4px; line-height: 34px; font-weight: bold; box-shadow: 0 1px 2px rgba(0,0,0,0.15);">e</span>
                            <span style="width: 26px; height: 34px; background: #fff; border-radius: 4px; line-height: 34px; box-shadow: 0 1px 2px rgba(0,0,0,0.15);">r</span>
                            <span style="width: 26px; height: 34px; background: #fff; border-radius: 4px; line-height: 34px; box-shadow: 0 1px 2px rgba(0,0,0,0.15);">t</span>
                        </div>
                    </div>
                    <p style="margin: 8px 0 0 0; font-size: 0.9em; text-align: center;">üëÜ Halte <strong>e</strong> gedr√ºckt ‚Üí w√§hle <strong style="color: var(--spanisch);">√©</strong> | F√ºr <strong>√±</strong>: Halte <strong>n</strong> gedr√ºckt</p>
                </div>
            </div>

            <div class="grammar-box">
                <h3>Wiederholung: Die Modalverben</h3>
                <table class="conj-table">
                    <tr>
                        <th></th>
                        <th>querer <span class="de">(wollen)</span></th>
                        <th>poder <span class="de">(k√∂nnen)</span></th>
                        <th>tener que <span class="de">(m√ºssen)</span></th>
                    </tr>
                    <tr>
                        <td class="pronoun">yo</td>
                        <td>qu<span class="ending">ie</span>ro</td>
                        <td>p<span class="ending">ue</span>do</td>
                        <td>tengo que</td>
                    </tr>
                    <tr>
                        <td class="pronoun">t√∫</td>
                        <td>qu<span class="ending">ie</span>res</td>
                        <td>p<span class="ending">ue</span>des</td>
                        <td>tienes que</td>
                    </tr>
                    <tr>
                        <td class="pronoun">√©l/ella</td>
                        <td>qu<span class="ending">ie</span>re</td>
                        <td>p<span class="ending">ue</span>de</td>
                        <td>tiene que</td>
                    </tr>
                    <tr>
                        <td class="pronoun">nosotros</td>
                        <td>queremos</td>
                        <td>podemos</td>
                        <td>tenemos que</td>
                    </tr>
                    <tr>
                        <td class="pronoun">vosotros</td>
                        <td>quer√©is</td>
                        <td>pod√©is</td>
                        <td>ten√©is que</td>
                    </tr>
                    <tr>
                        <td class="pronoun">ellos/ellas</td>
                        <td>qu<span class="ending">ie</span>ren</td>
                        <td>p<span class="ending">ue</span>den</td>
                        <td>tienen que</td>
                    </tr>
                </table>
                <p class="tip">Merke: Bei <strong>querer</strong> wird e‚Üíie, bei <strong>poder</strong> wird o‚Üíue (au√üer nosotros/vosotros)!</p>
            </div>

            <div class="exercise">
                <h3>√úbung 1: Konjugiere die Modalverben</h3>
                <div class="question">1. Yo (querer) <input type="text" id="modal-1" data-correct="quiero"> ir al cine.</div>
                <div class="question">2. Mar√≠a no (poder) <input type="text" id="modal-2" data-correct="puede"> venir a la fiesta.</div>
                <div class="question">3. Nosotros (tener que) <input type="text" id="modal-3" data-correct="tenemos que" style="width:150px;"> estudiar.</div>
                <div class="question">4. ¬øVosotros (querer) <input type="text" id="modal-4" data-correct="quer√©is"> comer pizza?</div>
                <div class="question">5. Ellos no (poder) <input type="text" id="modal-5" data-correct="pueden"> salir hoy.</div>
                <div class="question">6. T√∫ (tener que) <input type="text" id="modal-6" data-correct="tienes que" style="width:150px;"> hacer los deberes.</div>
                <button class="check-btn" onclick="checkInputs('modal', 6, 'modal-feedback')">√úberpr√ºfen</button>
                <div id="modal-feedback" class="feedback" style="display:none;"></div>
            </div>

            <div class="exercise">
                <h3>√úbung 2: Welches Modalverb passt?</h3>

                <div class="question">
                    <p>1. Mar√≠a no ___ comprar el vestido porque es muy caro. <span class="de">(Maria kann das Kleid nicht kaufen, weil es zu teuer ist.)</span></p>
                    <div class="mc-options" data-correct="puede">
                        <div class="mc-option" data-value="quiere">quiere</div>
                        <div class="mc-option" data-value="puede">puede</div>
                        <div class="mc-option" data-value="tiene que">tiene que</div>
                    </div>
                </div>

                <div class="question">
                    <p>2. Nosotros ___ ir a la playa ma√±ana. ¬°Qu√© bien! <span class="de">(Wir wollen morgen zum Strand. Toll!)</span></p>
                    <div class="mc-options" data-correct="queremos">
                        <div class="mc-option" data-value="queremos">queremos</div>
                        <div class="mc-option" data-value="podemos">podemos</div>
                        <div class="mc-option" data-value="tenemos que">tenemos que</div>
                    </div>
                </div>

                <div class="question">
                    <p>3. Los estudiantes ___ llevar uniforme. <span class="de">(Die Sch√ºler m√ºssen Schuluniform tragen.)</span></p>
                    <div class="mc-options" data-correct="tienen que">
                        <div class="mc-option" data-value="quieren">quieren</div>
                        <div class="mc-option" data-value="pueden">pueden</div>
                        <div class="mc-option" data-value="tienen que">tienen que</div>
                    </div>
                </div>
            </div>

            <button class="next-btn" onclick="completeAndNext(1)">Weiter zu Station 2 ‚Üí</button>
        </section>

        <!-- Station 2: Presente Continuo -->
        <section class="station" id="station-2">
            <div class="station-header">
                <div class="station-number">2</div>
                <div class="station-title">El presente continuo</div>
            </div>

            <div class="grammar-box">
                <h3>Bildung: estar + gerundio</h3>
                <p>Das presente continuo beschreibt, was <strong>gerade jetzt</strong> passiert.</p>

                <table class="conj-table">
                    <tr>
                        <th>estar</th>
                        <th>+ Gerundio</th>
                    </tr>
                    <tr><td>estoy</td><td rowspan="6" style="vertical-align: middle;">
                        <strong>-ar</strong> ‚Üí -<span class="ending">ando</span><br>
                        hablar ‚Üí habl<span class="ending">ando</span><br><br>
                        <strong>-er/-ir</strong> ‚Üí -<span class="ending">iendo</span><br>
                        comer ‚Üí com<span class="ending">iendo</span><br>
                        vivir ‚Üí viv<span class="ending">iendo</span>
                    </td></tr>
                    <tr><td>est√°s</td></tr>
                    <tr><td>est√°</td></tr>
                    <tr><td>estamos</td></tr>
                    <tr><td>est√°is</td></tr>
                    <tr><td>est√°n</td></tr>
                </table>

                <p class="tip"><strong>Unregelm√§√üig:</strong> leer ‚Üí ley<span class="ending">endo</span>, dormir ‚Üí durm<span class="ending">iendo</span>, pedir ‚Üí pid<span class="ending">iendo</span></p>
            </div>

            <div class="exercise">
                <h3>√úbung: Bilde das presente continuo</h3>
                <div class="question">1. Yo (hablar) <input type="text" id="cont-1" data-correct="estoy hablando" style="width:180px;"> por tel√©fono.</div>
                <div class="question">2. Mar√≠a (comer) <input type="text" id="cont-2" data-correct="est√° comiendo" style="width:180px;"> una manzana.</div>
                <div class="question">3. Nosotros (estudiar) <input type="text" id="cont-3" data-correct="estamos estudiando" style="width:180px;"> espa√±ol.</div>
                <div class="question">4. Los ni√±os (jugar) <input type="text" id="cont-4" data-correct="est√°n jugando" style="width:180px;"> en el parque.</div>
                <div class="question">5. T√∫ (leer) <input type="text" id="cont-5" data-correct="est√°s leyendo" style="width:180px;"> un libro.</div>
                <div class="question">6. Mi hermano (dormir) <input type="text" id="cont-6" data-correct="est√° durmiendo" style="width:180px;"> en su habitaci√≥n.</div>
                <button class="check-btn" onclick="checkInputs('cont', 6, 'continuo-feedback')">√úberpr√ºfen</button>
                <div id="continuo-feedback" class="feedback" style="display:none;"></div>
            </div>

            <button class="next-btn" onclick="completeAndNext(2)">Weiter zu Station 3 ‚Üí</button>
        </section>

        <!-- Station 3: Ropa y Colores -->
        <section class="station" id="station-3">
            <div class="station-header">
                <div class="station-number">3</div>
                <div class="station-title">La ropa y los colores</div>
            </div>

            <div class="grammar-box">
                <h3>Adjektivanpassung bei Farben</h3>
                <table class="conj-table">
                    <tr>
                        <th>Farbe</th>
                        <th>m. sg.</th>
                        <th>f. sg.</th>
                        <th>m. pl.</th>
                        <th>f. pl.</th>
                    </tr>
                    <tr>
                        <td>rot</td>
                        <td>rojo</td>
                        <td>roja</td>
                        <td>rojos</td>
                        <td>rojas</td>
                    </tr>
                    <tr>
                        <td>blau</td>
                        <td>azul</td>
                        <td>azul</td>
                        <td>azules</td>
                        <td>azules</td>
                    </tr>
                    <tr>
                        <td>gr√ºn</td>
                        <td>verde</td>
                        <td>verde</td>
                        <td>verdes</td>
                        <td>verdes</td>
                    </tr>
                    <tr>
                        <td>braun</td>
                        <td>marr√≥n</td>
                        <td>marr√≥n</td>
                        <td>marrones</td>
                        <td>marrones</td>
                    </tr>
                </table>
                <p class="tip"><strong>Unver√§nderlich:</strong> naranja, rosa (immer gleich!)</p>
            </div>

            <div class="exercise">
                <h3>√úbung: Passe die Farbadjektive an</h3>
                <div class="question">1. La camiseta (rojo) <input type="text" id="color-1" data-correct="roja"> es muy bonita.</div>
                <div class="question">2. Los pantalones (negro) <input type="text" id="color-2" data-correct="negros"> cuestan 30 euros.</div>
                <div class="question">3. Me gustan las faldas (verde) <input type="text" id="color-3" data-correct="verdes">.</div>
                <div class="question">4. El vestido (azul) <input type="text" id="color-4" data-correct="azul"> es elegante.</div>
                <div class="question">5. Las gorras (amarillo) <input type="text" id="color-5" data-correct="amarillas"> son de mi hermana.</div>
                <div class="question">6. Los zapatos (marr√≥n) <input type="text" id="color-6" data-correct="marrones"> son muy caros.</div>
                <div class="question">7. Quiero una chaqueta (blanco) <input type="text" id="color-7" data-correct="blanca">.</div>
                <div class="question">8. Los abrigos (gris) <input type="text" id="color-8" data-correct="grises"> est√°n en la tienda.</div>
                <button class="check-btn" onclick="checkInputs('color', 8, 'color-feedback')">√úberpr√ºfen</button>
                <div id="color-feedback" class="feedback" style="display:none;"></div>
            </div>

            <button class="next-btn" onclick="completeAndNext(3)">Weiter zu Station 4 ‚Üí</button>
        </section>

        <!-- Station 4: El Tiempo -->
        <section class="station" id="station-4">
            <div class="station-header">
                <div class="station-number">4</div>
                <div class="station-title">¬øQu√© tiempo hace?</div>
            </div>

            <div class="grammar-box">
                <h3>Wetterausdr√ºcke</h3>
                <table class="conj-table">
                    <tr>
                        <th>Espa√±ol</th>
                        <th>Deutsch</th>
                    </tr>
                    <tr><td>Hace sol</td><td>Die Sonne scheint</td></tr>
                    <tr><td>Hace calor</td><td>Es ist hei√ü</td></tr>
                    <tr><td>Hace fr√≠o</td><td>Es ist kalt</td></tr>
                    <tr><td>Hace viento</td><td>Es ist windig</td></tr>
                    <tr><td>Hace buen tiempo</td><td>Das Wetter ist gut</td></tr>
                    <tr><td>Est√° nublado</td><td>Es ist bew√∂lkt</td></tr>
                    <tr><td>Llueve</td><td>Es regnet</td></tr>
                    <tr><td>Nieva</td><td>Es schneit</td></tr>
                </table>
            </div>

            <div class="exercise">
                <h3>√úbung 1: Ordne zu (Tap to Match)</h3>
                <div class="match-grid">
                    <div class="match-column">
                        <h4>Deutsch</h4>
                        <div class="match-card" data-match="sol">Die Sonne scheint</div>
                        <div class="match-card" data-match="frio">Es ist kalt</div>
                        <div class="match-card" data-match="llueve">Es regnet</div>
                        <div class="match-card" data-match="nublado">Es ist bew√∂lkt</div>
                        <div class="match-card" data-match="nieva">Es schneit</div>
                        <div class="match-card" data-match="calor">Es ist hei√ü</div>
                        <div class="match-card" data-match="viento">Es ist windig</div>
                        <div class="match-card" data-match="buen">Das Wetter ist gut</div>
                    </div>
                    <div class="match-column">
                        <h4>Espa√±ol</h4>
                        <div class="match-card" data-match="calor">Hace calor</div>
                        <div class="match-card" data-match="nublado">Est√° nublado</div>
                        <div class="match-card" data-match="sol">Hace sol</div>
                        <div class="match-card" data-match="nieva">Nieva</div>
                        <div class="match-card" data-match="frio">Hace fr√≠o</div>
                        <div class="match-card" data-match="llueve">Llueve</div>
                        <div class="match-card" data-match="buen">Hace buen tiempo</div>
                        <div class="match-card" data-match="viento">Hace viento</div>
                    </div>
                </div>
                <div id="match-feedback" class="feedback" style="display:none;"></div>
            </div>

            <div class="exercise">
                <h3>√úbung 2: Welches Wetter passt?</h3>
                <div class="question">1. Im Sommer am Strand: <input type="text" id="tiempo-1" data-correct="Hace calor" style="width:150px;"> <span class="de">(Es ist hei√ü)</span></div>
                <div class="question">2. Im Winter in den Bergen: <input type="text" id="tiempo-2" data-correct="Nieva" style="width:150px;"> <span class="de">(Es schneit)</span></div>
                <div class="question">3. Heute brauche ich einen Regenschirm: <input type="text" id="tiempo-3" data-correct="Llueve" style="width:150px;"> <span class="de">(Es regnet)</span></div>
                <div class="question">4. Im Herbst, graue Wolken am Himmel: <input type="text" id="tiempo-4" data-correct="Est√° nublado" style="width:150px;"> <span class="de">(Es ist bew√∂lkt)</span></div>
                <button class="check-btn" onclick="checkInputs('tiempo-', 4, 'tiempo-feedback')">√úberpr√ºfen</button>
                <div id="tiempo-feedback" class="feedback" style="display:none;"></div>
            </div>

            <button class="next-btn" onclick="completeAndNext(4)">Weiter zu Station 5 ‚Üí</button>
        </section>

        <!-- Station 5: Preposiciones -->
        <section class="station" id="station-5">
            <div class="station-header">
                <div class="station-number">5</div>
                <div class="station-title">Las preposiciones de lugar</div>
            </div>

            <div class="grammar-box">
                <h3>Ortspr√§positionen</h3>
                <table class="conj-table">
                    <tr>
                        <th>Espa√±ol</th>
                        <th>Deutsch</th>
                    </tr>
                    <tr><td>enfrente de</td><td>gegen√ºber von</td></tr>
                    <tr><td>al lado de</td><td>neben</td></tr>
                    <tr><td>detr√°s de</td><td>hinter</td></tr>
                    <tr><td>delante de</td><td>vor</td></tr>
                    <tr><td>entre</td><td>zwischen</td></tr>
                    <tr><td>cerca de</td><td>in der N√§he von</td></tr>
                    <tr><td>lejos de</td><td>weit weg von</td></tr>
                    <tr><td>debajo de</td><td>unter</td></tr>
                    <tr><td>encima de</td><td>√ºber / auf</td></tr>
                </table>
            </div>

            <div class="exercise">
                <h3>√úbung: Erg√§nze die Pr√§position</h3>
                <div class="question">1. El banco est√° <input type="text" id="prep-1" data-correct="enfrente de" style="width:150px;"> la iglesia. <span class="de">(gegen√ºber)</span></div>
                <div class="question">2. La farmacia est√° <input type="text" id="prep-2" data-correct="al lado de" style="width:150px;"> el supermercado. <span class="de">(neben)</span></div>
                <div class="question">3. El cine est√° <input type="text" id="prep-3" data-correct="entre" style="width:150px;"> el restaurante y la librer√≠a. <span class="de">(zwischen)</span></div>
                <div class="question">4. La estaci√≥n est√° <input type="text" id="prep-4" data-correct="detr√°s de" style="width:150px;"> el hotel. <span class="de">(hinter)</span></div>
                <div class="question">5. El parque est√° <input type="text" id="prep-5" data-correct="cerca de" style="width:150px;"> mi casa. <span class="de">(in der N√§he von)</span></div>
                <div class="question">6. El gato est√° <input type="text" id="prep-6" data-correct="debajo de" style="width:150px;"> la mesa. <span class="de">(unter)</span></div>
                <button class="check-btn" onclick="checkInputs('prep', 6, 'prep-feedback')">√úberpr√ºfen</button>
                <div id="prep-feedback" class="feedback" style="display:none;"></div>
            </div>

            <button class="next-btn" onclick="completeAndNext(5)">Weiter zu Station 6 ‚Üí</button>
        </section>

        <!-- Station 6: Flashcards with Swipe -->
        <section class="station" id="station-6">
            <div class="station-header">
                <div class="station-number">6</div>
                <div class="station-title">Flashcards: Vokabeln</div>
            </div>

            <p>Tippe auf die Karte, um die √úbersetzung zu sehen. Dann wische nach rechts (‚úì gewusst) oder links (‚úó nicht gewusst).</p>

            <div class="fc-progress">
                <span id="fc-count">0 / 12</span>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="fc-progress-bar" style="width: 0%"></div>
                </div>
            </div>

            <div class="flashcard-area" id="flashcard-area">
                <div class="swipe-indicator left" id="swipe-left">‚úó</div>
                <div class="swipe-indicator right" id="swipe-right">‚úì</div>
                <div class="flashcard" id="flashcard" onclick="flipFlashcard()">
                    <div class="flashcard-face flashcard-front">
                        <div class="flashcard-word" id="fc-front">la camiseta</div>
                        <div class="flashcard-hint">Tippen zum Umdrehen</div>
                    </div>
                    <div class="flashcard-face flashcard-back">
                        <div class="flashcard-word" id="fc-back">das T-Shirt</div>
                        <button class="audio-btn" onclick="event.stopPropagation(); speakCurrent()">üîä</button>
                    </div>
                </div>
            </div>

            <div class="fc-controls">
                <button class="fc-btn wrong" onclick="flashcardAnswer(false)">‚úó Nochmal √ºben</button>
                <button class="fc-btn correct" onclick="flashcardAnswer(true)">‚úì Gewusst!</button>
            </div>

            <div class="score-display" id="fc-score" style="display:none;"></div>

            <button class="reset-btn" onclick="resetFlashcards()">Neu starten</button>
            <button class="next-btn" onclick="completeAndNext(6)">Weiter zu Station 7 ‚Üí</button>
        </section>

        <!-- Station 7: Memory -->
        <section class="station" id="station-7">
            <div class="station-header">
                <div class="station-number">7</div>
                <div class="station-title">Memory: Kleidung</div>
            </div>

            <p>Finde die passenden Paare! Tippe auf zwei Karten, um sie aufzudecken.</p>

            <div class="score-display" id="memory-score">Gefundene Paare: 0 / 8</div>

            <div class="memory-grid" id="memory-grid">
                <!-- Cards generated by JavaScript -->
            </div>

            <button class="reset-btn" onclick="resetMemory()">Neu starten</button>
            <button class="next-btn" onclick="completeAndNext(7)">Weiter zu Station 8 ‚Üí</button>
        </section>

        <!-- Station 8: Speed Drill -->
        <section class="station" id="station-8">
            <div class="station-header">
                <div class="station-number">8</div>
                <div class="station-title">Speed-Drill: Konjugation</div>
            </div>

            <p>Konjugiere so schnell wie m√∂glich! Du hast 60 Sekunden Zeit.</p>

            <div class="timer-display" id="timer">60</div>

            <div class="speed-round" id="speed-round">
                <div class="speed-prompt" id="speed-prompt">Dr√ºcke "Start" um zu beginnen!</div>
                <input type="text" class="speed-input" id="speed-input" placeholder="Antwort..." disabled>
            </div>

            <div class="score-display" id="speed-score">Punkte: 0</div>

            <button class="check-btn" id="speed-start-btn" onclick="startSpeedDrill()">Start!</button>
            <button class="reset-btn" onclick="resetSpeedDrill()" style="display:none;" id="speed-reset-btn">Nochmal</button>

            <div id="speed-feedback" class="feedback" style="display:none;"></div>

            <button class="next-btn" onclick="completeAndNext(8)">Weiter zu Station 9 ‚Üí</button>
        </section>

        <!-- Station 9: Foto beschreiben -->
        <section class="station" id="station-9">
            <div class="station-header">
                <div class="station-number">9</div>
                <div class="station-title">Descripci√≥n de una foto</div>
            </div>

            <div class="grammar-box">
                <h3>Struktur einer Bildbeschreibung</h3>
                <ol>
                    <li><strong>Einleitung:</strong> En la foto veo... / La foto muestra...</li>
                    <li><strong>Wetter:</strong> Hace sol / Hace buen tiempo / Est√° nublado...</li>
                    <li><strong>Personen:</strong> Hay un chico / una chica / personas...</li>
                    <li><strong>Kleidung:</strong> Lleva una camiseta roja / pantalones azules...</li>
                    <li><strong>Position:</strong> Est√° al lado de... / Est√° delante de...</li>
                    <li><strong>Aktivit√§ten:</strong> Est√° leyendo / Est√°n hablando... (presente continuo!)</li>
                </ol>
            </div>

            <div class="exercise">
                <h3>Satzbausteine (Drag & Drop) - Satz <span id="sentence-num">1</span> von 4</h3>
                <p id="sentence-instruction">Baue den Satz: "In dem Foto sehe ich einen Park. Es ist sonnig."</p>

                <div class="drop-zone" id="sentence-drop">
                    <span class="drop-zone-label">Ziehe die W√∂rter hierher...</span>
                </div>

                <div class="drag-container" id="sentence-drag"></div>

                <button class="check-btn" onclick="checkSentence()">√úberpr√ºfen</button>
                <button class="reset-btn" onclick="resetCurrentSentence()">Zur√ºcksetzen</button>
                <div id="sentence-feedback" class="feedback" style="display:none;"></div>
                <div class="score-display" id="sentence-score" style="margin-top:10px;">Richtige S√§tze: 0 / 4</div>
            </div>

            <button class="next-btn" onclick="completeAndNext(9)">Weiter zum Abschlusstest ‚Üí</button>
        </section>

        <!-- Station 10: Abschlusstest -->
        <section class="station" id="station-10">
            <div class="station-header">
                <div class="station-number">10</div>
                <div class="station-title">Abschlusstest</div>
            </div>

            <p>Teste dein Wissen mit diesem Abschlussquiz!</p>

            <div class="exercise" id="final-quiz">
                <div class="question" data-q="1">
                    <p><strong>1.</strong> Nosotros ___ ir al cine, pero no ___. <span class="de">(Wir wollen ins Kino, aber wir k√∂nnen nicht.)</span></p>
                    <div class="mc-options" data-correct="queremos / podemos">
                        <div class="mc-option" data-value="queremos / podemos">queremos / podemos</div>
                        <div class="mc-option" data-value="quieremos / podemos">quieremos / podemos</div>
                        <div class="mc-option" data-value="queremos / puedemos">queremos / puedemos</div>
                    </div>
                </div>

                <div class="question" data-q="2">
                    <p><strong>2.</strong> ¬øQu√© ___ Mar√≠a? - ___ un libro. <span class="de">(Was macht Mar√≠a gerade? - Sie liest ein Buch.)</span></p>
                    <div class="mc-options" data-correct="est√° haciendo / Est√° leyendo">
                        <div class="mc-option" data-value="est√° haciendo / Est√° leyendo">est√° haciendo / Est√° leyendo</div>
                        <div class="mc-option" data-value="hace / Lee">hace / Lee</div>
                        <div class="mc-option" data-value="est√° haciendo / Est√° leendo">est√° haciendo / Est√° leendo</div>
                    </div>
                </div>

                <div class="question" data-q="3">
                    <p><strong>3.</strong> Me gustan las camisetas ___. <span class="de">(Ich mag die blauen T-Shirts.)</span></p>
                    <div class="mc-options" data-correct="azules">
                        <div class="mc-option" data-value="azul">azul</div>
                        <div class="mc-option" data-value="azules">azules</div>
                        <div class="mc-option" data-value="azulas">azulas</div>
                    </div>
                </div>

                <div class="question" data-q="4">
                    <p><strong>4.</strong> "Es ist hei√ü und die Sonne scheint" auf Spanisch:</p>
                    <div class="mc-options" data-correct="Hace calor y hace sol">
                        <div class="mc-option" data-value="Est√° calor y est√° sol">Est√° calor y est√° sol</div>
                        <div class="mc-option" data-value="Hace calor y hace sol">Hace calor y hace sol</div>
                        <div class="mc-option" data-value="Es calor y es sol">Es calor y es sol</div>
                    </div>
                </div>

                <div class="question" data-q="5">
                    <p><strong>5.</strong> La farmacia est√° ___ el banco y la panader√≠a. <span class="de">(zwischen)</span></p>
                    <div class="mc-options" data-correct="entre">
                        <div class="mc-option" data-value="al lado de">al lado de</div>
                        <div class="mc-option" data-value="entre">entre</div>
                        <div class="mc-option" data-value="enfrente de">enfrente de</div>
                    </div>
                </div>

                <div class="question" data-q="6">
                    <p><strong>6.</strong> Los chicos ___ en el parque ahora mismo. <span class="de">(Die Jungen spielen gerade im Park.)</span></p>
                    <div class="mc-options" data-correct="est√°n jugando">
                        <div class="mc-option" data-value="juegan">juegan</div>
                        <div class="mc-option" data-value="est√°n jugando">est√°n jugando</div>
                        <div class="mc-option" data-value="est√°n juegando">est√°n juegando</div>
                    </div>
                </div>

                <div class="question" data-q="7">
                    <p><strong>7.</strong> Ella lleva una falda ___. <span class="de">(Sie tr√§gt einen schwarzen Rock.)</span></p>
                    <div class="mc-options" data-correct="negra">
                        <div class="mc-option" data-value="negro">negro</div>
                        <div class="mc-option" data-value="negra">negra</div>
                        <div class="mc-option" data-value="negros">negros</div>
                    </div>
                </div>

                <div class="question" data-q="8">
                    <p><strong>8.</strong> El supermercado est√° ___ la iglesia. <span class="de">(gegen√ºber von)</span></p>
                    <div class="mc-options" data-correct="enfrente de">
                        <div class="mc-option" data-value="detr√°s de">detr√°s de</div>
                        <div class="mc-option" data-value="enfrente de">enfrente de</div>
                        <div class="mc-option" data-value="cerca de">cerca de</div>
                    </div>
                </div>

                <div class="question" data-q="9">
                    <p><strong>9.</strong> Yo no ___ venir porque ___ estudiar. <span class="de">(Ich kann nicht kommen, weil ich lernen muss.)</span></p>
                    <div class="mc-options" data-correct="puedo / tengo que">
                        <div class="mc-option" data-value="puedo / tengo que">puedo / tengo que</div>
                        <div class="mc-option" data-value="quiero / puedo">quiero / puedo</div>
                        <div class="mc-option" data-value="puede / tiene que">puede / tiene que</div>
                    </div>
                </div>

                <div class="question" data-q="10">
                    <p><strong>10.</strong> "Es regnet und es ist kalt" auf Spanisch:</p>
                    <div class="mc-options" data-correct="Llueve y hace fr√≠o">
                        <div class="mc-option" data-value="Llueve y est√° fr√≠o">Llueve y est√° fr√≠o</div>
                        <div class="mc-option" data-value="Est√° lloviendo y hace fr√≠o">Est√° lloviendo y hace fr√≠o</div>
                        <div class="mc-option" data-value="Llueve y hace fr√≠o">Llueve y hace fr√≠o</div>
                    </div>
                </div>
            </div>

            <button class="check-btn" onclick="checkFinalQuiz()">Ergebnis anzeigen</button>
            <div id="final-feedback" class="feedback" style="display:none;"></div>

            <div id="completion" class="completion" style="display:none;">
                <h2>¬°Felicidades! Wiederholung abgeschlossen!</h2>
                <p>Du hast alle Stationen bearbeitet.</p>
                <div class="final-score" id="final-score">0 / 10</div>
                <p>Schau dir die Checklist an und wiederhole die Themen, bei denen du noch unsicher bist.</p>
                <button class="check-btn" onclick="location.reload()">Nochmal √ºben</button>
            </div>
        </section>
    </div>

    <script>
        // ==================== AUDIO (Text-to-Speech) ====================
        let currentSpeech = null;

        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'es-ES';
                utterance.rate = 0.9;

                // Find Spanish voice
                const voices = window.speechSynthesis.getVoices();
                const spanishVoice = voices.find(v => v.lang.startsWith('es'));
                if (spanishVoice) utterance.voice = spanishVoice;

                window.speechSynthesis.speak(utterance);
            }
        }

        // Load voices
        if ('speechSynthesis' in window) {
            window.speechSynthesis.getVoices();
            window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();
        }


        // ==================== STATION NAVIGATION ====================
        let completedStations = new Set();

        function showStation(num) {
            document.querySelectorAll('.station').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.station-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('station-' + num).classList.add('active');
            document.querySelectorAll('.station-btn')[num - 1].classList.add('active');
            window.scrollTo(0, 0);
        }

        function completeAndNext(num) {
            completedStations.add(num);
            document.querySelectorAll('.station-btn')[num - 1].classList.add('completed');
            if (num < 10) showStation(num + 1);
        }

        // ==================== INPUT CHECKING ====================
        function checkInputs(prefix, count, feedbackId) {
            let correct = 0;
            for (let i = 1; i <= count; i++) {
                const input = document.getElementById(prefix + '-' + i);
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = input.dataset.correct.toLowerCase();

                if (userAnswer === correctAnswer) {
                    input.classList.remove('incorrect');
                    input.classList.add('correct');
                    correct++;
                } else {
                    input.classList.remove('correct');
                    input.classList.add('incorrect');
                }
            }

            const feedback = document.getElementById(feedbackId);
            feedback.style.display = 'block';
            if (correct === count) {
                feedback.className = 'feedback success';
                feedback.textContent = '¬°Perfecto! Alle Antworten sind richtig!';
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${correct} von ${count} richtig. Versuche es nochmal!`;
            }
        }

        // ==================== MULTIPLE CHOICE ====================
        document.querySelectorAll('.mc-option').forEach(option => {
            option.addEventListener('click', function() {
                const parent = this.closest('.mc-options');
                parent.querySelectorAll('.mc-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // ==================== MATCH GAME ====================
        let selectedMatch = null;
        let matchedPairs = 0;

        document.querySelectorAll('.match-card').forEach(card => {
            card.addEventListener('click', function() {
                if (this.classList.contains('matched')) return;

                if (!selectedMatch) {
                    selectedMatch = this;
                    this.classList.add('selected');
                } else if (selectedMatch === this) {
                    this.classList.remove('selected');
                    selectedMatch = null;
                } else {
                    if (selectedMatch.dataset.match === this.dataset.match) {
                        selectedMatch.classList.remove('selected');
                        selectedMatch.classList.add('matched');
                        this.classList.add('matched');
                        matchedPairs++;

                        if (matchedPairs === 8) {
                            const feedback = document.getElementById('match-feedback');
                            feedback.style.display = 'block';
                            feedback.className = 'feedback success';
                            feedback.textContent = '¬°Muy bien! Alle Paare gefunden!';
                        }
                    } else {
                        selectedMatch.classList.remove('selected');
                    }
                    selectedMatch = null;
                }
            });
        });

        // ==================== FLASHCARDS ====================
        const flashcardData = [
            // Kleidung
            { es: 'la camiseta', de: 'das T-Shirt' },
            { es: 'los pantalones', de: 'die Hose' },
            { es: 'el vestido', de: 'das Kleid' },
            { es: 'la falda', de: 'der Rock' },
            { es: 'el jersey', de: 'der Pullover' },
            { es: 'los zapatos', de: 'die Schuhe' },
            { es: 'la chaqueta', de: 'die Jacke' },
            { es: 'el abrigo', de: 'der Mantel' },
            { es: 'la gorra', de: 'die M√ºtze' },
            { es: 'las zapatillas', de: 'die Turnschuhe' },
            { es: 'el cintur√≥n', de: 'der G√ºrtel' },
            { es: 'los calcetines', de: 'die Socken' },
            // Wetter
            { es: 'Hace sol', de: 'Die Sonne scheint' },
            { es: 'Hace calor', de: 'Es ist hei√ü' },
            { es: 'Hace fr√≠o', de: 'Es ist kalt' },
            { es: 'Llueve', de: 'Es regnet' },
            { es: 'Est√° nublado', de: 'Es ist bew√∂lkt' },
            // Pr√§positionen
            { es: 'enfrente de', de: 'gegen√ºber von' },
            { es: 'al lado de', de: 'neben' },
            { es: 'detr√°s de', de: 'hinter' },
            { es: 'delante de', de: 'vor' },
            { es: 'cerca de', de: 'in der N√§he von' }
        ];

        let fcIndex = 0;
        let fcCorrect = 0;
        let fcDeck = [...flashcardData];

        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function updateFlashcard() {
            if (fcIndex >= fcDeck.length) {
                document.getElementById('fc-score').style.display = 'block';
                document.getElementById('fc-score').textContent = `¬°Terminado! ${fcCorrect} von ${fcDeck.length} gewusst!`;
                return;
            }

            const card = fcDeck[fcIndex];
            document.getElementById('fc-front').textContent = card.es;
            document.getElementById('fc-back').textContent = card.de;
            document.getElementById('flashcard').classList.remove('flipped', 'swipe-left', 'swipe-right');
            document.getElementById('fc-count').textContent = `${fcIndex + 1} / ${fcDeck.length}`;
            document.getElementById('fc-progress-bar').style.width = `${(fcIndex / fcDeck.length) * 100}%`;
        }

        function flipFlashcard() {
            document.getElementById('flashcard').classList.toggle('flipped');
        }

        function speakCurrent() {
            if (fcIndex < fcDeck.length) {
                speak(fcDeck[fcIndex].es);
            }
        }

        function flashcardAnswer(correct) {
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.add(correct ? 'swipe-right' : 'swipe-left');

            if (correct) fcCorrect++;

            setTimeout(() => {
                fcIndex++;
                updateFlashcard();
            }, 300);
        }

        function resetFlashcards() {
            fcIndex = 0;
            fcCorrect = 0;
            shuffleArray(fcDeck);
            document.getElementById('fc-score').style.display = 'none';
            updateFlashcard();
        }

        // ==================== MEMORY GAME ====================
        const memoryPairs = [
            { es: 'la camiseta', de: 'das T-Shirt' },
            { es: 'los pantalones', de: 'die Hose' },
            { es: 'el vestido', de: 'das Kleid' },
            { es: 'la falda', de: 'der Rock' },
            { es: 'el jersey', de: 'der Pullover' },
            { es: 'los zapatos', de: 'die Schuhe' },
            { es: 'la chaqueta', de: 'die Jacke' },
            { es: 'el abrigo', de: 'der Mantel' }
        ];

        const pairColors = [
            '#e8f5e9', // hellgr√ºn
            '#e3f2fd', // hellblau
            '#fff3e0', // hellorange
            '#f3e5f5', // helllila
            '#fff8e1', // hellgelb
            '#e0f7fa', // hellt√ºrkis
            '#fce4ec', // hellrosa
            '#f1f8e9'  // helloliv
        ];

        let memoryCards = [];
        let flippedCards = [];
        let memoryMatched = 0;

        function initMemory() {
            const grid = document.getElementById('memory-grid');
            grid.innerHTML = '';
            memoryCards = [];
            flippedCards = [];
            memoryMatched = 0;
            updateMemoryScore();

            const cards = [];
            memoryPairs.forEach((pair, idx) => {
                cards.push({ text: pair.es, pairId: idx, type: 'es' });
                cards.push({ text: pair.de, pairId: idx, type: 'de' });
            });

            shuffleArray(cards);

            cards.forEach((card, idx) => {
                const div = document.createElement('div');
                div.className = 'memory-card';
                div.innerHTML = `<span class="card-back">?</span><span class="card-front">${card.text}</span>`;
                div.dataset.pairId = card.pairId;
                div.dataset.type = card.type;
                div.addEventListener('click', () => flipMemoryCard(div));
                grid.appendChild(div);
                memoryCards.push(div);
            });
        }

        function flipMemoryCard(card) {
            if (card.classList.contains('flipped') || card.classList.contains('matched') || flippedCards.length >= 2) return;

            card.classList.add('flipped');
            flippedCards.push(card);

            if (flippedCards.length === 2) {
                setTimeout(checkMemoryMatch, 800);
            }
        }

        function checkMemoryMatch() {
            const [card1, card2] = flippedCards;

            if (card1.dataset.pairId === card2.dataset.pairId) {
                const pairId = parseInt(card1.dataset.pairId);
                const color = pairColors[pairId];
                card1.classList.add('matched');
                card2.classList.add('matched');
                card1.style.background = color;
                card2.style.background = color;
                memoryMatched++;
                updateMemoryScore();
            } else {
                card1.classList.remove('flipped');
                card2.classList.remove('flipped');
            }

            flippedCards = [];
        }

        function updateMemoryScore() {
            document.getElementById('memory-score').textContent = `Gefundene Paare: ${memoryMatched} / 8`;
        }

        function resetMemory() { initMemory(); }

        // ==================== SPEED DRILL ====================
        const speedQuestions = [
            // Modalverben
            { prompt: 'yo / querer', answer: 'quiero' },
            { prompt: 't√∫ / poder', answer: 'puedes' },
            { prompt: '√©l / tener que', answer: 'tiene que' },
            { prompt: 'nosotros / querer', answer: 'queremos' },
            { prompt: 'ellos / poder', answer: 'pueden' },
            { prompt: 'vosotros / querer', answer: 'quer√©is' },
            { prompt: 'ella / querer', answer: 'quiere' },
            { prompt: 'yo / poder', answer: 'puedo' },
            { prompt: 'nosotros / poder', answer: 'podemos' },
            { prompt: 't√∫ / tener que', answer: 'tienes que' },
            // Presente continuo
            { prompt: 'yo / estar (gerundio: hablar)', answer: 'estoy hablando' },
            { prompt: 'ella / estar (gerundio: comer)', answer: 'est√° comiendo' },
            { prompt: 'nosotros / estar (gerundio: estudiar)', answer: 'estamos estudiando' },
            { prompt: 't√∫ / estar (gerundio: leer)', answer: 'est√°s leyendo' },
            { prompt: 'ellos / estar (gerundio: dormir)', answer: 'est√°n durmiendo' },
            { prompt: 'yo / estar (gerundio: escribir)', answer: 'estoy escribiendo' },
            { prompt: '√©l / estar (gerundio: jugar)', answer: 'est√° jugando' },
            { prompt: 'vosotros / estar (gerundio: correr)', answer: 'est√°is corriendo' },
            // Farbadjektive
            { prompt: 'camiseta (rojo, f.)', answer: 'roja' },
            { prompt: 'pantalones (negro, m. pl.)', answer: 'negros' },
            { prompt: 'faldas (verde, f. pl.)', answer: 'verdes' },
            { prompt: 'zapatos (marr√≥n, m. pl.)', answer: 'marrones' }
        ];

        let speedTimer = 60;
        let speedScore = 0;
        let speedInterval = null;
        let speedQIndex = 0;
        let speedDeck = [];

        function startSpeedDrill() {
            speedTimer = 60;
            speedScore = 0;
            speedQIndex = 0;
            speedDeck = [...speedQuestions];
            shuffleArray(speedDeck);

            document.getElementById('speed-start-btn').style.display = 'none';
            document.getElementById('speed-reset-btn').style.display = 'inline-block';
            document.getElementById('speed-input').disabled = false;
            document.getElementById('speed-input').focus();
            document.getElementById('speed-feedback').style.display = 'none';

            updateSpeedQuestion();
            updateSpeedScore();

            speedInterval = setInterval(() => {
                speedTimer--;
                const timerEl = document.getElementById('timer');
                timerEl.textContent = speedTimer;

                if (speedTimer <= 10) timerEl.className = 'timer-display danger';
                else if (speedTimer <= 20) timerEl.className = 'timer-display warning';
                else timerEl.className = 'timer-display';

                if (speedTimer <= 0) {
                    endSpeedDrill();
                }
            }, 1000);

            document.getElementById('speed-input').addEventListener('keypress', handleSpeedInput);
        }

        function handleSpeedInput(e) {
            if (e.key === 'Enter') {
                const input = document.getElementById('speed-input');
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = speedDeck[speedQIndex].answer.toLowerCase();

                if (userAnswer === correctAnswer) {
                    speedScore++;
                    updateSpeedScore();
                }

                speedQIndex++;
                if (speedQIndex >= speedDeck.length) {
                    shuffleArray(speedDeck);
                    speedQIndex = 0;
                }

                input.value = '';
                updateSpeedQuestion();
            }
        }

        function updateSpeedQuestion() {
            document.getElementById('speed-prompt').textContent = speedDeck[speedQIndex].prompt;
        }

        function updateSpeedScore() {
            document.getElementById('speed-score').textContent = `Punkte: ${speedScore}`;
        }

        function endSpeedDrill() {
            clearInterval(speedInterval);
            document.getElementById('speed-input').disabled = true;
            document.getElementById('speed-input').removeEventListener('keypress', handleSpeedInput);

            const feedback = document.getElementById('speed-feedback');
            feedback.style.display = 'block';

            if (speedScore >= 15) {
                feedback.className = 'feedback success';
                feedback.textContent = `¬°Excelente! ${speedScore} Punkte! Du bist ein Konjugations-Profi!`;
            } else if (speedScore >= 10) {
                feedback.className = 'feedback success';
                feedback.textContent = `¬°Muy bien! ${speedScore} Punkte! Gute Leistung!`;
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${speedScore} Punkte. √úbe weiter!`;
            }
        }

        function resetSpeedDrill() {
            clearInterval(speedInterval);
            document.getElementById('timer').textContent = '60';
            document.getElementById('timer').className = 'timer-display';
            document.getElementById('speed-prompt').textContent = 'Dr√ºcke "Start" um zu beginnen!';
            document.getElementById('speed-input').value = '';
            document.getElementById('speed-input').disabled = true;
            document.getElementById('speed-start-btn').style.display = 'inline-block';
            document.getElementById('speed-reset-btn').style.display = 'none';
            document.getElementById('speed-feedback').style.display = 'none';
            document.getElementById('speed-score').textContent = 'Punkte: 0';
        }

        // ==================== DRAG & DROP SENTENCE ====================
        const allSentences = [
            {
                words: ['En', 'la', 'foto', 'veo', 'un', 'parque.', 'Hace', 'sol.'],
                hint: 'Baue den Satz: "In dem Foto sehe ich einen Park. Es ist sonnig."'
            },
            {
                words: ['Una', 'chica', 'est√°', 'leyendo', 'un', 'libro.'],
                hint: 'Baue den Satz: "Ein M√§dchen liest gerade ein Buch."'
            },
            {
                words: ['El', 'chico', 'lleva', 'una', 'camiseta', 'roja.'],
                hint: 'Baue den Satz: "Der Junge tr√§gt ein rotes T-Shirt."'
            },
            {
                words: ['Hay', 'muchas', 'personas', 'en', 'el', 'parque.'],
                hint: 'Baue den Satz: "Es gibt viele Personen im Park."'
            }
        ];

        let currentSentenceIdx = 0;
        let sentencesCorrect = 0;

        function initDragDrop() {
            currentSentenceIdx = 0;
            sentencesCorrect = 0;
            updateSentenceScore();
            loadSentence(0);

            const dropZone = document.getElementById('sentence-drop');
            dropZone.addEventListener('dragover', handleDragOver);
            dropZone.addEventListener('drop', handleDrop);
            dropZone.addEventListener('dragleave', handleDragLeave);
        }

        function loadSentence(idx) {
            const dragContainer = document.getElementById('sentence-drag');
            const dropZone = document.getElementById('sentence-drop');
            dragContainer.innerHTML = '';
            dropZone.innerHTML = '<span class="drop-zone-label">Ziehe die W√∂rter hierher...</span>';
            dropZone.classList.remove('correct', 'incorrect');
            document.getElementById('sentence-feedback').style.display = 'none';

            document.getElementById('sentence-num').textContent = idx + 1;
            document.getElementById('sentence-instruction').textContent = allSentences[idx].hint;

            const words = [...allSentences[idx].words];
            shuffleArray(words);

            words.forEach(word => {
                const div = document.createElement('div');
                div.className = 'drag-item';
                div.draggable = true;
                div.dataset.word = word;
                div.textContent = word;
                div.addEventListener('dragstart', handleDragStart);
                div.addEventListener('dragend', handleDragEnd);
                div.addEventListener('click', handleDragClick);
                dragContainer.appendChild(div);
            });
        }

        function updateSentenceScore() {
            document.getElementById('sentence-score').textContent = `Richtige S√§tze: ${sentencesCorrect} / ${allSentences.length}`;
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.word);
            e.target.classList.add('dragging');
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('hover');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('hover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('hover');
            const word = e.dataTransfer.getData('text/plain');
            addWordToDropZone(word);
        }

        function handleDragClick(e) {
            const item = e.currentTarget;
            const parent = item.parentElement;

            if (parent.id === 'sentence-drag') {
                addWordToDropZone(item.dataset.word);
            } else {
                // Move back to drag container
                document.getElementById('sentence-drag').appendChild(item);
            }
        }

        function addWordToDropZone(word) {
            const dropZone = document.getElementById('sentence-drop');
            const dragContainer = document.getElementById('sentence-drag');

            // Remove label if present
            const label = dropZone.querySelector('.drop-zone-label');
            if (label) label.remove();

            // Find and move the item
            const items = dragContainer.querySelectorAll('.drag-item');
            items.forEach(item => {
                if (item.dataset.word === word) {
                    dropZone.appendChild(item);
                }
            });
        }

        function checkSentence() {
            const dropZone = document.getElementById('sentence-drop');
            const items = dropZone.querySelectorAll('.drag-item');
            const userSentence = Array.from(items).map(i => i.dataset.word);
            const correctSentence = allSentences[currentSentenceIdx].words;

            const feedback = document.getElementById('sentence-feedback');
            feedback.style.display = 'block';

            if (JSON.stringify(userSentence) === JSON.stringify(correctSentence)) {
                dropZone.classList.add('correct');
                dropZone.classList.remove('incorrect');
                sentencesCorrect++;
                updateSentenceScore();

                if (currentSentenceIdx < allSentences.length - 1) {
                    feedback.className = 'feedback success';
                    feedback.textContent = '¬°Perfecto! Weiter zum n√§chsten Satz...';
                    setTimeout(() => {
                        currentSentenceIdx++;
                        loadSentence(currentSentenceIdx);
                    }, 1200);
                } else {
                    feedback.className = 'feedback success';
                    feedback.textContent = `¬°Excelente! Alle ${allSentences.length} S√§tze richtig!`;
                }
            } else {
                dropZone.classList.add('incorrect');
                dropZone.classList.remove('correct');
                feedback.className = 'feedback error';
                feedback.textContent = 'Nicht ganz richtig. Versuche es nochmal!';
            }
        }

        function resetCurrentSentence() {
            loadSentence(currentSentenceIdx);
        }

        function resetSentence() {
            currentSentenceIdx = 0;
            sentencesCorrect = 0;
            updateSentenceScore();
            loadSentence(0);
        }

        // ==================== FINAL QUIZ ====================
        function checkFinalQuiz() {
            let correct = 0;
            const questions = document.querySelectorAll('#final-quiz .question');

            questions.forEach(q => {
                const options = q.querySelector('.mc-options');
                const correctAnswer = options.dataset.correct;
                const selected = q.querySelector('.mc-option.selected');

                if (selected) {
                    if (selected.dataset.value === correctAnswer) {
                        selected.classList.add('correct');
                        correct++;
                    } else {
                        selected.classList.add('incorrect');
                        options.querySelectorAll('.mc-option').forEach(o => {
                            if (o.dataset.value === correctAnswer) o.classList.add('correct');
                        });
                    }
                }
            });

            const feedback = document.getElementById('final-feedback');
            feedback.style.display = 'block';

            if (correct >= 9) {
                feedback.className = 'feedback success';
                feedback.textContent = '¬°Excelente! Du bist bestens vorbereitet!';
            } else if (correct >= 7) {
                feedback.className = 'feedback success';
                feedback.textContent = `${correct} von 10 richtig. ¬°Muy bien!`;
            } else {
                feedback.className = 'feedback error';
                feedback.textContent = `${correct} von 10 richtig. Wiederhole die entsprechenden Stationen.`;
            }

            document.getElementById('completion').style.display = 'block';
            document.getElementById('final-score').textContent = `${correct} / 10 Punkte`;
        }

        // ==================== INITIALIZATION ====================
        shuffleArray(fcDeck);
        updateFlashcard();
        initMemory();
        initDragDrop();
    </script>
</body>
</html>
