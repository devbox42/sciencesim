<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lernpfad: FreikÃ¶rperbild & Newton I | Physik 10E</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-size: 16px; line-height: 1.6; color: #222; background: #f5f5f5;
        }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        :root {
            --physik: #2c5aa0; --physik-light: #e8f0fa;
            --success: #2a7a4b; --success-light: #e8f5e9;
            --warning: #b35c00; --warning-light: #fff3e0;
            --error: #c62828; --error-light: #ffebee;
            --gray: #666; --border: #ddd;
            --kraft-rot: #c62828; --kraft-blau: #1565c0;
        }
        header { background: var(--physik); color: white; padding: 20px; text-align: center; }
        header h1 { font-size: 1.5em; font-weight: 600; margin-bottom: 5px; }
        header .meta { font-size: 0.85em; opacity: 0.9; }
        .progress-bar { background: #ddd; height: 8px; width: 100%; }
        .progress-fill { background: var(--physik); height: 100%; width: 0%; transition: width 0.3s; }
        .step-indicator { display: flex; justify-content: center; gap: 8px; padding: 15px; background: white; border-bottom: 1px solid var(--border); flex-wrap: wrap; }
        .step-dot { width: 12px; height: 12px; border-radius: 50%; background: #ddd; cursor: pointer; transition: all 0.2s; }
        .step-dot:hover { transform: scale(1.2); }
        .step-dot.active { background: var(--physik); }
        .step-dot.completed { background: var(--success); }
        .step { display: none; background: white; padding: 25px; margin: 20px 0; border: 1px solid var(--border); }
        .step.active { display: block; }
        .step h2 { color: var(--physik); font-size: 1.3em; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--physik-light); }
        .step h3 { font-size: 1.1em; margin: 20px 0 10px 0; color: #333; }
        .info-box { background: var(--physik-light); border-left: 4px solid var(--physik); padding: 15px; margin: 15px 0; }
        .ab-box { background: #e3f2fd; border-left: 4px solid #1976d2; padding: 15px; margin: 15px 0; }
        .formel-box { background: #f9f9f9; border: 2px solid var(--physik); padding: 20px; margin: 20px 0; text-align: center; font-size: 1.3em; }
        .merksatz { background: var(--success-light); border-left: 4px solid var(--success); padding: 15px; margin: 15px 0; font-weight: 500; }
        .wichtig { background: var(--warning-light); border: 2px solid var(--warning); padding: 15px; margin: 15px 0; }
        .sim-container { background: #f9f9f9; border: 1px solid var(--border); padding: 15px; margin: 20px 0; }
        .sim-container h4 { color: var(--physik); margin-bottom: 10px; font-size: 1em; }
        canvas { display: block; margin: 10px auto; background: white; border: 1px solid var(--border); touch-action: none; }
        .sim-controls { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px; align-items: center; justify-content: center; }
        .sim-controls label { display: flex; align-items: center; gap: 8px; font-size: 0.9em; }
        .sim-controls input[type="range"] { width: 120px; height: 44px; }
        .sim-controls button { min-width: 44px; min-height: 44px; padding: 10px 20px; }
        .var { font-style: italic; }
        .unit { font-style: normal; }
        .exercise { background: #fafafa; border: 1px solid var(--border); padding: 20px; margin: 20px 0; }
        .exercise-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .exercise-title { font-weight: 600; color: var(--physik); }
        .niveau-badge { font-size: 0.8em; padding: 2px 8px; border-radius: 3px; background: var(--physik-light); color: var(--physik); }
        .exercise textarea { width: 100%; min-height: 80px; padding: 10px; border: 1px solid var(--border); font-family: inherit; font-size: 1em; resize: vertical; }
        .exercise input[type="text"] { padding: 8px 12px; border: 1px solid var(--border); font-size: 1em; width: 100%; max-width: 400px; }
        .feedback { margin-top: 15px; padding: 12px; display: none; }
        .feedback.correct { display: block; background: var(--success-light); border-left: 4px solid var(--success); color: var(--success); }
        .feedback.incorrect { display: block; background: var(--error-light); border-left: 4px solid var(--error); color: #333; }
        .feedback.hint { display: block; background: var(--warning-light); border-left: 4px solid var(--warning); color: #333; }
        .quiz-option { display: block; padding: 12px 15px; margin: 8px 0; background: white; border: 2px solid var(--border); cursor: pointer; transition: all 0.2s; }
        .quiz-option:hover { border-color: var(--physik); }
        .quiz-option.selected { border-color: var(--physik); background: var(--physik-light); }
        .quiz-option.correct { border-color: var(--success); background: var(--success-light); }
        .quiz-option.wrong { border-color: var(--error); background: var(--error-light); }
        button { padding: 10px 20px; font-size: 1em; cursor: pointer; border: none; background: var(--physik); color: white; min-height: 44px; }
        button:hover { opacity: 0.9; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-secondary { background: white; color: var(--physik); border: 2px solid var(--physik); }
        .btn-success { background: var(--success); }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border); }

        /* FKB Builder KÃ¶rper-Karten */
        .body-cards { display: flex; gap: 15px; justify-content: center; margin: 15px 0; flex-wrap: wrap; }
        .body-card { padding: 12px 24px; border: 2px solid var(--border); background: white; cursor: pointer; text-align: center; min-width: 100px; min-height: 44px; transition: all 0.2s; font-weight: 600; }
        .body-card:hover { border-color: var(--physik); }
        .body-card.selected { border-color: var(--physik); background: var(--physik-light); }

        /* Szenario-Tabs */
        .scenario-tabs { display: flex; gap: 10px; justify-content: center; margin: 15px 0; flex-wrap: wrap; }
        .scenario-tab { padding: 10px 20px; border: 2px solid var(--border); background: white; cursor: pointer; min-height: 44px; transition: all 0.2s; }
        .scenario-tab:hover { border-color: var(--physik); }
        .scenario-tab.active { border-color: var(--physik); background: var(--physik-light); font-weight: 600; }

        /* IS Zuordnung */
        .is-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .is-column { border: 2px solid var(--border); padding: 15px; min-height: 200px; }
        .is-column h4 { text-align: center; margin-bottom: 10px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
        .is-column.is-ja { border-color: var(--success); }
        .is-column.is-ja h4 { color: var(--success); }
        .is-column.is-nein { border-color: var(--error); }
        .is-column.is-nein h4 { color: var(--error); }
        .is-item { padding: 10px 15px; margin: 8px 0; background: white; border: 2px solid var(--border); cursor: grab; touch-action: none; user-select: none; min-height: 44px; display: flex; align-items: center; }
        .is-item.dragging { opacity: 0.5; }
        .is-item.correct-placed { border-color: var(--success); background: var(--success-light); }
        .is-item.wrong-placed { border-color: var(--error); background: var(--error-light); }

        @media (max-width: 600px) {
            .container { padding: 10px; }
            .step { padding: 15px; }
            canvas { max-width: 100%; height: auto; }
            .is-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <h1>FreikÃ¶rperbild & Newton I</h1>
    <div class="meta">Physik 10E | DS2 | Fortsetzung: Von der Wechselwirkung zur Bewegung</div>
</header>

<div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
</div>
<div class="step-indicator" id="stepIndicator"></div>

<div class="container">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 1: RECAP NEWTON III
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step active" id="step1">
        <h2>1. Kurzer RÃ¼ckblick: Newton III</h2>

        <div class="info-box">
            <strong>Letzte Stunde</strong> hast du gelernt: KrÃ¤fte treten immer paarweise auf (Wechselwirkungsgesetz).
            Heute geht es weiter: Wie bestimmt man die <strong>Bewegung</strong> eines KÃ¶rpers?
        </div>

        <div class="exercise">
            <p><strong>Frage 1:</strong> Wie lautet Newton III in Vektorschreibweise?</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option" data-correct="true"><input type="radio" name="recap1" value="a"> <span class="var">F</span>âƒ—<sub>Aâ†’B</sub> = âˆ’<span class="var">F</span>âƒ—<sub>Bâ†’A</sub></label>
                <label class="quiz-option"><input type="radio" name="recap1" value="b"> <span class="var">F</span>âƒ—<sub>Aâ†’B</sub> = <span class="var">F</span>âƒ—<sub>Bâ†’A</sub></label>
                <label class="quiz-option"><input type="radio" name="recap1" value="c"> <span class="var">F</span>âƒ—<sub>Aâ†’B</sub> + <span class="var">F</span>âƒ—<sub>Bâ†’A</sub> = <span class="var">F</span>âƒ—<sub>res</sub></label>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Frage 2:</strong> Die beiden KrÃ¤fte eines Wechselwirkungspaares sind...</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="recap2" value="a"> ...unterschiedlicher Kraftart</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="recap2" value="b"> ...gleich groÃŸ, entgegengesetzt und von gleicher Kraftart</label>
                <label class="quiz-option"><input type="radio" name="recap2" value="c"> ...unterschiedlich groÃŸ bei unterschiedlichen Massen</label>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Frage 3:</strong> Warum bewegt sich eine Rakete im Vakuum?</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="recap3" value="a"> Sie stÃ¶ÃŸt sich von der Luft ab</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="recap3" value="b"> Wechselwirkung Rakete â†” Abgase: Die Abgase drÃ¼cken die Rakete</label>
                <label class="quiz-option"><input type="radio" name="recap3" value="c"> Die Schwerkraft zieht sie nach oben</label>
            </div>
        </div>

        <button onclick="checkRecap()" style="margin-top: 15px;">Recap prÃ¼fen</button>
        <div class="feedback" id="fb-recap"></div>

        <div class="nav-buttons">
            <span></span>
            <button onclick="nextStep()">Weiter â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 2: FREIKÃ–RPERBILD
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step" id="step2">
        <h2>2. Der entscheidende Unterschied: Das FreikÃ¶rperbild</h2>

        <div class="wichtig">
            <strong>Die zentrale Frage:</strong> Newton III beschreibt KrÃ¤ftepaare zwischen <em>zwei</em> KÃ¶rpern.
            <br><br>
            Aber was bestimmt die <strong>Bewegung eines einzelnen KÃ¶rpers</strong>?
            <br>â†’ DafÃ¼r mÃ¼ssen wir alle KrÃ¤fte <strong>auf diesen einen KÃ¶rper</strong> betrachten!
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
            <div style="background: #ffebee; padding: 20px; border: 2px solid var(--kraft-rot);">
                <strong>Newton III (Wechselwirkung):</strong><br>
                KrÃ¤ftepaar zwischen <strong>ZWEI</strong> KÃ¶rpern
                <ul style="margin: 10px 0 0 20px;">
                    <li>Buch drÃ¼ckt Tisch â†“</li>
                    <li>Tisch drÃ¼ckt Buch â†‘</li>
                </ul>
            </div>
            <div style="background: #e3f2fd; padding: 20px; border: 2px solid var(--kraft-blau);">
                <strong>FreikÃ¶rperbild (FKB):</strong><br>
                Alle KrÃ¤fte auf <strong>EINEN</strong> KÃ¶rper
                <ul style="margin: 10px 0 0 20px;">
                    <li><span class="var">F</span><sub>G</sub> (Gewichtskraft) â†“</li>
                    <li><span class="var">F</span><sub>N</sub> (Normalkraft) â†‘</li>
                </ul>
                â†’ bestimmt die <strong>Bewegung</strong>!
            </div>
        </div>

        <div class="sim-container">
            <h4>ğŸ” Interaktiv: FKB Builder</h4>
            <p>WÃ¤hle einen KÃ¶rper aus und sieh dir an, welche KrÃ¤fte auf ihn wirken.</p>

            <div class="body-cards">
                <div class="body-card" onclick="selectFKBBody('buch')">ğŸ“š Buch</div>
                <div class="body-card" onclick="selectFKBBody('tisch')">ğŸªµ Tisch</div>
                <div class="body-card" onclick="selectFKBBody('erde')">ğŸŒ Erde</div>
            </div>

            <div style="text-align: center; margin: 10px 0;">
                <button id="fkbToggle" class="btn-secondary" onclick="toggleFKBView()" style="font-size: 0.9em;">Ansicht: FKB</button>
            </div>

            <canvas id="fkbBuilderCanvas" width="700" height="350"></canvas>

            <div id="fkb-info" style="margin-top: 15px; padding: 15px; background: var(--physik-light); display: none;">
            </div>
        </div>

        <div class="exercise">
            <p><strong>PrÃ¼fung:</strong> Wie viele KrÃ¤fte wirken auf das <strong>Buch</strong> (im FKB)?</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="fkb-q" value="1"> 1 Kraft</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="fkb-q" value="2"> 2 KrÃ¤fte</label>
                <label class="quiz-option"><input type="radio" name="fkb-q" value="4"> 4 KrÃ¤fte</label>
            </div>
            <button onclick="checkFKBQuiz()" style="margin-top: 10px;">PrÃ¼fen</button>
            <div class="feedback" id="fb-fkb-q"></div>
        </div>

        <div class="merksatz">
            <strong>Merke:</strong> Das FreikÃ¶rperbild zeigt nur die KrÃ¤fte, die <em>auf den betrachteten KÃ¶rper</em> wirken.
            Die GegenkrÃ¤fte (die er auf andere KÃ¶rper ausÃ¼bt) werden NICHT eingezeichnet!
        </div>

        <div class="ab-box">
            <strong>ğŸ“‹ Arbeitsblatt:</strong> Lies den Merkkasten zu <strong>Aufgabe A5</strong> auf deinem AB.
        </div>

        <div class="nav-buttons">
            <button class="btn-secondary" onclick="prevStep()">â† ZurÃ¼ck</button>
            <button onclick="nextStep()">Weiter â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 3: RESULTIERENDE KRAFT
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step" id="step3">
        <h2>3. Die resultierende Kraft</h2>

        <div class="info-box">
            Wenn mehrere KrÃ¤fte auf einen KÃ¶rper wirken, kÃ¶nnen wir sie zu einer
            <strong>resultierenden Kraft</strong> zusammenfassen.
        </div>

        <div class="formel-box">
            <strong>Resultierende Kraft:</strong><br><br>
            <span style="font-size: 1.3em;"><span class="var">F</span>âƒ—<sub>res</sub> = <span class="var">F</span>âƒ—<sub>1</sub> + <span class="var">F</span>âƒ—<sub>2</sub> + <span class="var">F</span>âƒ—<sub>3</sub> + ...</span>
            <br><br>
            <span style="font-size: 0.9em; color: var(--gray);">(Vektoraddition aller KrÃ¤fte auf den KÃ¶rper)</span>
        </div>

        <h3>Berechne die resultierende Kraft:</h3>

        <div class="sim-container">
            <h4>ğŸ“Š KrÃ¤fte-Szenarien</h4>
            <div class="scenario-tabs">
                <div class="scenario-tab active" onclick="showFresScenario(0)">ğŸ“š Buch auf Tisch</div>
                <div class="scenario-tab" onclick="showFresScenario(1)">ğŸ Fallender Apfel</div>
                <div class="scenario-tab" onclick="showFresScenario(2)">ğŸš€ Startende Rakete</div>
            </div>
            <canvas id="fresCanvas" width="700" height="300"></canvas>
        </div>

        <div id="fres-exercise-0" class="exercise">
            <div class="exercise-header">
                <span class="exercise-title">Buch auf dem Tisch (ruhend)</span>
                <span class="niveau-badge">â˜…â˜…</span>
            </div>
            <p><span class="var">F</span><sub>G</sub> = 5 N (nach unten), <span class="var">F</span><sub>N</sub> = 5 N (nach oben)</p>
            <p style="margin-top: 10px;">
                <span class="var">F</span><sub>res</sub> = <input type="text" id="fres1" style="width: 80px;" placeholder="?"> N
            </p>
            <button onclick="checkFres(0)" style="margin-top: 10px;">PrÃ¼fen</button>
            <div class="feedback" id="fb-fres0"></div>
        </div>

        <div id="fres-exercise-1" class="exercise" style="display: none;">
            <div class="exercise-header">
                <span class="exercise-title">Fallender Apfel</span>
                <span class="niveau-badge">â˜…â˜…</span>
            </div>
            <p><span class="var">F</span><sub>G</sub> = 1 N (nach unten), keine weiteren KrÃ¤fte</p>
            <p style="margin-top: 10px;">
                <span class="var">F</span><sub>res</sub> = <input type="text" id="fres2" style="width: 80px;" placeholder="?"> N (Richtung:
                <select id="fres2dir"><option value="">wÃ¤hlen...</option><option value="unten">nach unten</option><option value="oben">nach oben</option></select>)
            </p>
            <button onclick="checkFres(1)" style="margin-top: 10px;">PrÃ¼fen</button>
            <div class="feedback" id="fb-fres1"></div>
        </div>

        <div id="fres-exercise-2" class="exercise" style="display: none;">
            <div class="exercise-header">
                <span class="exercise-title">Startende Rakete</span>
                <span class="niveau-badge">â˜…â˜…</span>
            </div>
            <p><span class="var">F</span><sub>Schub</sub> = 35.000 kN (nach oben), <span class="var">F</span><sub>G</sub> = 30.000 kN (nach unten)</p>
            <p style="margin-top: 10px;">
                <span class="var">F</span><sub>res</sub> = <input type="text" id="fres3" style="width: 100px;" placeholder="?"> kN (Richtung:
                <select id="fres3dir"><option value="">wÃ¤hlen...</option><option value="oben">nach oben</option><option value="unten">nach unten</option></select>)
            </p>
            <button onclick="checkFres(2)" style="margin-top: 10px;">PrÃ¼fen</button>
            <div class="feedback" id="fb-fres2"></div>
        </div>

        <div id="fres-erkenntnis" style="display: none;">
            <div class="merksatz">
                <strong>Erkenntnisse:</strong>
                <ul style="margin: 10px 0 0 20px;">
                    <li><span class="var">F</span><sub>res</sub> = 0 â†’ KÃ¶rper bleibt in Ruhe (Buch)</li>
                    <li><span class="var">F</span><sub>res</sub> â‰  0 â†’ KÃ¶rper wird beschleunigt (Apfel, Rakete)</li>
                </ul>
                Die resultierende Kraft bestimmt die <strong>BewegungsÃ¤nderung</strong>!
            </div>
        </div>

        <div class="ab-box">
            <strong>ğŸ“‹ Arbeitsblatt:</strong> Bearbeite <strong>Aufgabe A5 a) und b)</strong> auf deinem AB â€“ berechne die resultierenden KrÃ¤fte und erklÃ¤re, was <span class="var">F</span><sub>res</sub> = 0 bedeutet.
        </div>

        <div class="nav-buttons">
            <button class="btn-secondary" onclick="prevStep()">â† ZurÃ¼ck</button>
            <button onclick="nextStep()">Weiter â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 4: NEWTON I â€“ TRÃ„GHEITSGESETZ
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step" id="step4">
        <h2>4. Newton I: Das TrÃ¤gheitsgesetz</h2>

        <div class="info-box">
            <strong>Die entscheidende Frage:</strong> Was passiert mit einem KÃ¶rper, wenn die resultierende Kraft null ist?
        </div>

        <h3>Experiment 1: Im Bus</h3>

        <div class="sim-container">
            <h4>ğŸšŒ Simulation: TrÃ¤gheit im Bus</h4>
            <canvas id="busCanvas" width="700" height="300"></canvas>
            <div class="sim-controls">
                <button id="busBtn" onclick="startBus()">â–¶ GleichmÃ¤ÃŸig fahren</button>
                <button id="brakeBtn" onclick="brakeBus()" disabled>ğŸ›‘ Bremsen!</button>
                <button class="btn-secondary" onclick="resetBus()">â†º ZurÃ¼cksetzen</button>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Beobachtung:</strong> Was passiert mit der Person, wenn der Bus plÃ¶tzlich bremst?</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option" data-correct="true"><input type="radio" name="bus-q" value="a"> Die Person kippt nach vorn â€“ ihr KÃ¶rper "will" sich weiterbewegen</label>
                <label class="quiz-option"><input type="radio" name="bus-q" value="b"> Die Person kippt nach hinten</label>
                <label class="quiz-option"><input type="radio" name="bus-q" value="c"> Die Person bleibt aufrecht stehen</label>
            </div>
            <button onclick="checkBusQ()" style="margin-top: 10px;">PrÃ¼fen</button>
            <div class="feedback" id="fb-bus-q"></div>
        </div>

        <h3>Experiment 2: MÃ¼nze auf Pappe</h3>

        <div class="sim-container">
            <h4>ğŸª™ Simulation: MÃ¼nze auf Pappe</h4>
            <canvas id="coinCanvas" width="500" height="250"></canvas>
            <div class="sim-controls">
                <button id="coinBtn" onclick="pullCard()">ğŸ‘† Pappe wegziehen!</button>
                <button class="btn-secondary" onclick="resetCoin()">â†º ZurÃ¼cksetzen</button>
            </div>
        </div>

        <div class="formel-box">
            <strong>Newton I â€“ TrÃ¤gheitsgesetz:</strong><br><br>
            <span style="font-size: 1.1em;">
                Ein KÃ¶rper verharrt im Zustand der Ruhe oder der gleichfÃ¶rmig geradlinigen Bewegung,<br>
                solange die resultierende Kraft auf ihn <strong>null</strong> ist.
            </span><br><br>
            <span style="font-size: 1.3em;"><span class="var">F</span>âƒ—<sub>res</sub> = 0 â†’ <span class="var">v</span>âƒ— = konstant</span>
        </div>

        <div class="merksatz">
            <strong>TrÃ¤gheit:</strong> KÃ¶rper "wollen" ihren Bewegungszustand beibehalten.
            Um sie zu beschleunigen oder abzubremsen, braucht man eine resultierende Kraft â‰  0.
        </div>

        <div class="ab-box">
            <strong>ğŸ“‹ Arbeitsblatt:</strong> Bearbeite <strong>Aufgabe A6 a) und b)</strong> auf deinem AB â€“ formuliere Newton I und notiere die formale Schreibweise.
        </div>

        <div class="nav-buttons">
            <button class="btn-secondary" onclick="prevStep()">â† ZurÃ¼ck</button>
            <button onclick="nextStep()">Weiter â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 5: INERTIALSYSTEM
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step" id="step5">
        <h2>5. Inertialsystem: Wo gilt Newton I?</h2>

        <div class="wichtig">
            <strong>Achtung:</strong> Newton I gilt <strong>nicht in jedem Bezugssystem</strong>!
            <br><br>
            Ein <strong>Inertialsystem (IS)</strong> ist ein Bezugssystem, in dem krÃ¤ftefreie KÃ¶rper
            in Ruhe bleiben oder sich geradlinig gleichfÃ¶rmig bewegen.
            <br><br>
            In beschleunigten Bezugssystemen spÃ¼rt man <strong>ScheinkrÃ¤fte</strong> (z.B. Fliehkraft im Karussell),
            die es im Inertialsystem nicht gibt!
        </div>

        <h3>Ordne zu: Inertialsystem oder nicht?</h3>

        <p>Ziehe die Situationen in die richtige Spalte:</p>

        <div id="is-source" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 15px 0;">
            <div class="is-item" draggable="true" data-is="ja" data-id="labor">ğŸ”¬ Labor auf der ErdoberflÃ¤che</div>
            <div class="is-item" draggable="true" data-is="nein" data-id="auto">ğŸš— Beschleunigendes Auto</div>
            <div class="is-item" draggable="true" data-is="ja" data-id="ice">ğŸš„ ICE mit konstanter Geschwindigkeit</div>
            <div class="is-item" draggable="true" data-is="nein" data-id="karussell">ğŸ  Karussell</div>
        </div>

        <div class="is-grid">
            <div class="is-column is-ja" id="is-ja-col">
                <h4>âœ“ Inertialsystem</h4>
            </div>
            <div class="is-column is-nein" id="is-nein-col">
                <h4>âœ— Kein Inertialsystem</h4>
            </div>
        </div>

        <button onclick="checkIS()" style="margin-top: 15px;">Zuordnung prÃ¼fen</button>
        <div class="feedback" id="fb-is"></div>

        <div id="is-explanations" style="display: none; margin-top: 20px;">
            <h3>ErklÃ¤rungen:</h3>
            <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                <tr style="background: var(--success-light);"><td style="padding: 8px; border: 1px solid var(--border);"><strong>ğŸ”¬ Labor</strong></td><td style="padding: 8px; border: 1px solid var(--border);">âœ“ IS (nÃ¤herungsweise) â€“ Erdrotation vernachlÃ¤ssigbar fÃ¼r die meisten Experimente</td></tr>
                <tr style="background: var(--error-light);"><td style="padding: 8px; border: 1px solid var(--border);"><strong>ğŸš— Beschl. Auto</strong></td><td style="padding: 8px; border: 1px solid var(--border);">âœ— kein IS â€“ Man wird in den Sitz gedrÃ¼ckt (Scheinkraft), obwohl keine echte Kraft wirkt</td></tr>
                <tr style="background: var(--success-light);"><td style="padding: 8px; border: 1px solid var(--border);"><strong>ğŸš„ ICE (v = const)</strong></td><td style="padding: 8px; border: 1px solid var(--border);">âœ“ IS â€“ Keine Beschleunigung, Newton I gilt. Ein Ball bleibt liegen.</td></tr>
                <tr style="background: var(--error-light);"><td style="padding: 8px; border: 1px solid var(--border);"><strong>ğŸ  Karussell</strong></td><td style="padding: 8px; border: 1px solid var(--border);">âœ— kein IS â€“ StÃ¤ndige RichtungsÃ¤nderung = Beschleunigung â†’ Zentrifugalkraft (Scheinkraft)</td></tr>
            </table>
        </div>

        <div class="ab-box">
            <strong>ğŸ“‹ Arbeitsblatt:</strong> Bearbeite <strong>Aufgabe A6 c)</strong> auf deinem AB â€“ kreuze an und begrÃ¼nde: Inertialsystem ja oder nein?
        </div>

        <div class="nav-buttons">
            <button class="btn-secondary" onclick="prevStep()">â† ZurÃ¼ck</button>
            <button onclick="nextStep()">Weiter â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 6: ZUSAMMENFASSUNG + QUIZ
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step" id="step6">
        <h2>6. Zusammenfassung</h2>

        <div class="merksatz">
            <strong>FreikÃ¶rperbild (FKB):</strong><br>
            Zeigt alle KrÃ¤fte, die auf <strong>einen</strong> KÃ¶rper wirken (nicht die GegenkrÃ¤fte auf andere KÃ¶rper).
        </div>

        <div class="merksatz">
            <strong>Resultierende Kraft:</strong><br>
            <span class="var">F</span>âƒ—<sub>res</sub> = Î£<span class="var">F</span>âƒ— â€” Summe aller KrÃ¤fte auf einen KÃ¶rper.
        </div>

        <div class="merksatz">
            <strong>Newton I â€“ TrÃ¤gheitsgesetz:</strong><br>
            <span class="var">F</span>âƒ—<sub>res</sub> = 0 â†’ KÃ¶rper bleibt in Ruhe oder bewegt sich gleichfÃ¶rmig geradlinig.
        </div>

        <div class="merksatz">
            <strong>Inertialsystem:</strong><br>
            Bezugssystem, in dem Newton I gilt. In beschleunigten Systemen treten ScheinkrÃ¤fte auf.
        </div>

        <h3>Abschluss-Quiz</h3>

        <div class="exercise">
            <p><strong>Frage 1:</strong> Der Unterschied zwischen Newton III und FKB ist...</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="q6-1" value="a"> Newton III betrachtet einen KÃ¶rper, FKB zwei KÃ¶rper</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="q6-1" value="b"> Newton III betrachtet KrÃ¤ftepaare zwischen zwei KÃ¶rpern, FKB alle KrÃ¤fte auf einen KÃ¶rper</label>
                <label class="quiz-option"><input type="radio" name="q6-1" value="c"> Es gibt keinen Unterschied</label>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Frage 2:</strong> Ein Buch liegt ruhig auf dem Tisch. Die resultierende Kraft ist...</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option" data-correct="true"><input type="radio" name="q6-2" value="a"> ...null (Gleichgewicht)</label>
                <label class="quiz-option"><input type="radio" name="q6-2" value="b"> ...gleich der Gewichtskraft</label>
                <label class="quiz-option"><input type="radio" name="q6-2" value="c"> ...gleich der Normalkraft</label>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Frage 3:</strong> Newton I besagt: Wenn <span class="var">F</span><sub>res</sub> = 0, dann...</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="q6-3" value="a"> ...steht der KÃ¶rper still</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="q6-3" value="b"> ...bleibt der Bewegungszustand erhalten (Ruhe oder gleichfÃ¶rmige Bewegung)</label>
                <label class="quiz-option"><input type="radio" name="q6-3" value="c"> ...beschleunigt der KÃ¶rper</label>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Frage 4:</strong> Ein Karussell ist kein Inertialsystem, weil...</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="q6-4" value="a"> ...es sich nicht bewegt</label>
                <label class="quiz-option"><input type="radio" name="q6-4" value="b"> ...es zu schnell ist</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="q6-4" value="c"> ...es stÃ¤ndig die Richtung Ã¤ndert (Beschleunigung) und ScheinkrÃ¤fte auftreten</label>
            </div>
        </div>

        <div class="exercise">
            <p><strong>Frage 5:</strong> <span class="var">F</span><sub>Schub</sub> = 35.000 kN (â†‘), <span class="var">F</span><sub>G</sub> = 30.000 kN (â†“). Die Rakete...</p>
            <div style="margin-top: 10px;">
                <label class="quiz-option"><input type="radio" name="q6-5" value="a"> ...bleibt am Boden</label>
                <label class="quiz-option" data-correct="true"><input type="radio" name="q6-5" value="b"> ...hebt ab, weil <span class="var">F</span><sub>res</sub> = 5.000 kN nach oben</label>
                <label class="quiz-option"><input type="radio" name="q6-5" value="c"> ...schwebt (Gleichgewicht)</label>
            </div>
        </div>

        <button onclick="checkFinalQuiz()" style="margin-top: 20px;">Quiz auswerten</button>
        <div class="feedback" id="fb-final"></div>

        <div class="ab-box">
            <strong>ğŸ“‹ Arbeitsblatt:</strong> VervollstÃ¤ndige <strong>Aufgabe A7</strong> (Zusammenfassung / LÃ¼ckentext) auf deinem AB.
        </div>

        <div class="nav-buttons">
            <button class="btn-secondary" onclick="prevStep()">â† ZurÃ¼ck</button>
            <button onclick="nextStep()">Weiter â†’</button>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         SCHRITT 7: AUSBLICK NEWTON II
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="step" id="step7">
        <h2>7. Ausblick: Newton II</h2>

        <div class="info-box">
            <strong>Heute gelernt:</strong><br>
            Newton I: <span class="var">F</span>âƒ—<sub>res</sub> = 0 â†’ <span class="var">v</span>âƒ— = konstant
            <br><br>
            <strong>Die nÃ¤chste groÃŸe Frage:</strong><br>
            Was passiert, wenn <span class="var">F</span>âƒ—<sub>res</sub> â‰  0?
            <strong>Wie stark</strong> beschleunigt ein KÃ¶rper?
        </div>

        <div class="formel-box">
            <strong>Newton II â€“ Das Grundgesetz der Mechanik:</strong><br><br>
            <span style="font-size: 1.5em;"><span class="var">F</span>âƒ— = <span class="var">m</span> Â· <span class="var">a</span>âƒ—</span>
            <br><br>
            <span style="font-size: 0.9em; color: var(--gray);">NÃ¤chste Stunde!</span>
        </div>

        <div class="ab-box" style="background: #fff3e0; border-color: #ff9800;">
            <strong>ğŸ“‹ Arbeitsblatt â€“ FÃ¼r Schnelle (â˜…â˜…â˜…):</strong>
            <ul style="margin: 10px 0 0 20px;">
                <li><strong>Aufgabe A8:</strong> Airbag-Physik â€“ Wie hilft Newton III bei der Sicherheitstechnik?</li>
                <li><strong>Aufgabe A9:</strong> Modellgrenzen â€“ Wann gilt Newton III nicht mehr?</li>
            </ul>
        </div>

        <div style="text-align: center; margin-top: 30px; padding: 20px; background: var(--success-light); border: 2px solid var(--success);">
            <p style="font-size: 1.2em; color: var(--success);"><strong>Geschafft!</strong></p>
            <p style="margin-top: 10px;">Du kennst jetzt Newton I und III, das FreikÃ¶rperbild und die resultierende Kraft.</p>
            <p style="margin-top: 10px; font-size: 0.9em; color: var(--gray);">NÃ¤chste Stunde: Newton II â€“ <span class="var">F</span>âƒ— = <span class="var">m</span> Â· <span class="var">a</span>âƒ—</p>
        </div>

        <div class="nav-buttons">
            <button class="btn-secondary" onclick="prevStep()">â† ZurÃ¼ck</button>
            <button class="btn-success" onclick="finish()">âœ“ AbschlieÃŸen</button>
        </div>
    </div>

</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KONFIGURATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LP_ID = 'lp-physik-10e-02-fkb-newton1';
const TOTAL_STEPS = 7;
let currentStep = 1;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init() {
    const indicator = document.getElementById('stepIndicator');
    for (let i = 1; i <= TOTAL_STEPS; i++) {
        const dot = document.createElement('div');
        dot.className = 'step-dot' + (i === 1 ? ' active' : '');
        dot.setAttribute('data-step', i);
        dot.onclick = () => goToStep(i);
        indicator.appendChild(dot);
    }
    const saved = localStorage.getItem(LP_ID + '-step');
    if (saved) { currentStep = parseInt(saved); goToStep(currentStep); }

    initFKBBuilder();
    initFresCanvas();
    initBus();
    initCoin();
    initDragDrop();
}

function goToStep(step) {
    if (step < 1 || step > TOTAL_STEPS) return;
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    document.getElementById('step' + step).classList.add('active');
    document.querySelectorAll('.step-dot').forEach((dot, i) => {
        dot.classList.remove('active');
        dot.classList.toggle('completed', i + 1 < step);
        if (i + 1 === step) dot.classList.add('active');
    });
    document.getElementById('progressFill').style.width = ((step - 1) / (TOTAL_STEPS - 1)) * 100 + '%';
    currentStep = step;
    localStorage.setItem(LP_ID + '-step', step);
    window.scrollTo(0, 0);
}
function nextStep() { goToStep(currentStep + 1); }
function prevStep() { goToStep(currentStep - 1); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HILFSFUNKTIONEN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function drawArrow(ctx, x1, y1, x2, y2, color, width) {
    const headLen = 15;
    const angle = Math.atan2(y2 - y1, x2 - x1);
    ctx.strokeStyle = color; ctx.fillStyle = color; ctx.lineWidth = width;
    ctx.beginPath(); ctx.moveTo(x1, y1); ctx.lineTo(x2, y2); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(x2, y2);
    ctx.lineTo(x2 - headLen * Math.cos(angle - Math.PI/6), y2 - headLen * Math.sin(angle - Math.PI/6));
    ctx.lineTo(x2 - headLen * Math.cos(angle + Math.PI/6), y2 - headLen * Math.sin(angle + Math.PI/6));
    ctx.closePath(); ctx.fill();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 1: RECAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function checkRecap() {
    let correct = 0;
    const r1 = document.querySelector('input[name="recap1"]:checked');
    const r2 = document.querySelector('input[name="recap2"]:checked');
    const r3 = document.querySelector('input[name="recap3"]:checked');
    if (r1 && r1.value === 'a') correct++;
    if (r2 && r2.value === 'b') correct++;
    if (r3 && r3.value === 'b') correct++;
    const fb = document.getElementById('fb-recap');
    if (correct === 3) {
        fb.className = 'feedback correct';
        fb.innerHTML = 'âœ“ Alles richtig! Du bist bereit fÃ¼r die nÃ¤chsten Konzepte.';
    } else {
        fb.className = 'feedback hint';
        fb.innerHTML = correct + '/3 richtig. Schau dir die falschen Antworten noch einmal an.';
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 2: FKB BUILDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let fkbCanvas, fkbCtx;
let fkbSelectedBody = 'buch';
let fkbViewMode = 'fkb'; // 'fkb' oder 'n3'

function initFKBBuilder() {
    fkbCanvas = document.getElementById('fkbBuilderCanvas');
    if (!fkbCanvas) return;
    fkbCtx = fkbCanvas.getContext('2d');
    selectFKBBody('buch');
}

function selectFKBBody(body) {
    fkbSelectedBody = body;
    document.querySelectorAll('.body-card').forEach(c => c.classList.remove('selected'));
    event && event.currentTarget && event.currentTarget.classList.add('selected');
    drawFKBScene();
    updateFKBInfo();
}

function toggleFKBView() {
    fkbViewMode = fkbViewMode === 'fkb' ? 'n3' : 'fkb';
    document.getElementById('fkbToggle').textContent = 'Ansicht: ' + (fkbViewMode === 'fkb' ? 'FKB' : 'Newton III');
    drawFKBScene();
    updateFKBInfo();
}

function drawFKBScene() {
    if (!fkbCtx) return;
    const ctx = fkbCtx;
    const w = fkbCanvas.width, h = fkbCanvas.height;
    ctx.clearRect(0, 0, w, h);

    // Hintergrund
    ctx.fillStyle = '#fafafa';
    ctx.fillRect(0, 0, w, h);

    const tischY = h * 0.6;
    const buchY = tischY - 30;
    const buchX = w/2;
    const isN3 = fkbViewMode === 'n3';

    // Erde (ganz unten)
    ctx.fillStyle = isN3 || fkbSelectedBody === 'erde' ? '#8d6e63' : '#e0e0e0';
    ctx.fillRect(0, h - 40, w, 40);
    ctx.fillStyle = isN3 || fkbSelectedBody === 'erde' ? '#5d4037' : '#bdbdbd';
    ctx.font = 'bold 14px sans-serif'; ctx.textAlign = 'center';
    ctx.fillText('Erde', w/2, h - 15);

    // Tisch
    ctx.fillStyle = isN3 || fkbSelectedBody === 'tisch' ? '#a1887f' : '#e0e0e0';
    ctx.fillRect(buchX - 80, tischY, 160, 15);
    // Tischbeine
    ctx.fillRect(buchX - 70, tischY + 15, 10, 60);
    ctx.fillRect(buchX + 60, tischY + 15, 10, 60);
    ctx.fillStyle = isN3 || fkbSelectedBody === 'tisch' ? '#5d4037' : '#bdbdbd';
    ctx.fillText('Tisch', buchX, tischY + 50);

    // Buch
    ctx.fillStyle = isN3 || fkbSelectedBody === 'buch' ? '#42a5f5' : '#e0e0e0';
    ctx.fillRect(buchX - 40, buchY, 80, 30);
    ctx.strokeStyle = isN3 || fkbSelectedBody === 'buch' ? '#1565c0' : '#bdbdbd';
    ctx.lineWidth = 2; ctx.strokeRect(buchX - 40, buchY, 80, 30);
    ctx.fillStyle = isN3 || fkbSelectedBody === 'buch' ? 'white' : '#bdbdbd';
    ctx.font = 'bold 14px sans-serif';
    ctx.fillText('Buch', buchX, buchY + 20);

    // KrÃ¤fte zeichnen
    if (fkbViewMode === 'fkb') {
        drawFKBForces(ctx, buchX, buchY, tischY);
    } else {
        drawN3Forces(ctx, buchX, buchY, tischY);
    }

    ctx.textAlign = 'left';
}

function drawFKBForces(ctx, buchX, buchY, tischY) {
    const sel = fkbSelectedBody;
    if (sel === 'buch') {
        // FG nach unten
        drawArrow(ctx, buchX - 15, buchY + 30, buchX - 15, buchY + 100, '#c62828', 4);
        ctx.fillStyle = '#c62828'; ctx.font = 'italic 13px sans-serif'; ctx.textAlign = 'left';
        ctx.fillText('F\u20D7G = 5 N', buchX - 5, buchY + 75);
        // FN nach oben
        drawArrow(ctx, buchX + 15, buchY, buchX + 15, buchY - 70, '#2e7d32', 4);
        ctx.fillStyle = '#2e7d32';
        ctx.fillText('F\u20D7N = 5 N', buchX + 25, buchY - 35);
        // Info
        ctx.fillStyle = var_color('#1565c0'); ctx.font = 'bold 13px sans-serif'; ctx.textAlign = 'center';
        ctx.fillText('FKB: Buch â€” 2 KrÃ¤fte â†’ Fres = 0 (Gleichgewicht)', buchX, 30);
    } else if (sel === 'tisch') {
        // FG Tisch
        drawArrow(ctx, buchX - 20, tischY + 15, buchX - 20, tischY + 80, '#c62828', 4);
        ctx.fillStyle = '#c62828'; ctx.font = 'italic 13px sans-serif'; ctx.textAlign = 'left';
        ctx.fillText('F\u20D7G,Tisch', buchX - 10, tischY + 55);
        // Buch drÃ¼ckt auf Tisch
        drawArrow(ctx, buchX, tischY, buchX, tischY + 50, '#ff9800', 3);
        ctx.fillStyle = '#ff9800';
        ctx.fillText('F\u20D7Buchâ†’Tisch', buchX + 10, tischY + 35);
        // FN vom Boden
        drawArrow(ctx, buchX + 20, tischY + 75, buchX + 20, tischY + 20, '#2e7d32', 4);
        ctx.fillStyle = '#2e7d32';
        ctx.fillText('F\u20D7N,Boden', buchX + 30, tischY + 45);
        ctx.fillStyle = '#1565c0'; ctx.font = 'bold 13px sans-serif'; ctx.textAlign = 'center';
        ctx.fillText('FKB: Tisch â€” 3 KrÃ¤fte â†’ Fres = 0', buchX, 30);
    } else if (sel === 'erde') {
        // Buch zieht Erde (nach oben, winzig)
        const erdeY = fkbCanvas.height - 40;
        drawArrow(ctx, buchX, erdeY, buchX, erdeY - 30, '#9c27b0', 3);
        ctx.fillStyle = '#9c27b0'; ctx.font = 'italic 13px sans-serif'; ctx.textAlign = 'left';
        ctx.fillText('F\u20D7Buchâ†’Erde (winzig!)', buchX + 10, erdeY - 15);
        ctx.fillStyle = '#1565c0'; ctx.font = 'bold 13px sans-serif'; ctx.textAlign = 'center';
        ctx.fillText('FKB: Erde â€” Das Buch zieht die Erde an (minimal!)', buchX, 30);
    }
}

function var_color(c) { return c; }

function drawN3Forces(ctx, buchX, buchY, tischY) {
    // WW-Paar 1: Buch â†” Erde (Gravitation)
    drawArrow(ctx, buchX - 25, buchY + 30, buchX - 25, buchY + 100, '#c62828', 4);
    ctx.fillStyle = '#c62828'; ctx.font = 'italic 12px sans-serif'; ctx.textAlign = 'left';
    ctx.fillText('F\u20D7Erdeâ†’Buch', buchX - 15, buchY + 75);

    drawArrow(ctx, buchX - 25, fkbCanvas.height - 40, buchX - 25, fkbCanvas.height - 70, '#c62828', 3);
    ctx.fillText('F\u20D7Buchâ†’Erde', buchX - 15, fkbCanvas.height - 50);

    // WW-Paar 2: Buch â†” Tisch (Kontakt)
    drawArrow(ctx, buchX + 25, buchY, buchX + 25, buchY - 70, '#1565c0', 4);
    ctx.fillStyle = '#1565c0';
    ctx.fillText('F\u20D7Tischâ†’Buch', buchX + 35, buchY - 35);

    drawArrow(ctx, buchX + 25, tischY, buchX + 25, tischY + 50, '#1565c0', 3);
    ctx.fillText('F\u20D7Buchâ†’Tisch', buchX + 35, tischY + 35);

    ctx.fillStyle = '#333'; ctx.font = 'bold 13px sans-serif'; ctx.textAlign = 'center';
    ctx.fillText('Newton III: 2 Wechselwirkungspaare (auf verschiedenen KÃ¶rpern!)', buchX, 30);
}

function updateFKBInfo() {
    const el = document.getElementById('fkb-info');
    el.style.display = 'block';
    if (fkbViewMode === 'n3') {
        el.innerHTML = '<strong>Newton III Ansicht:</strong> Hier siehst du die <em>Wechselwirkungspaare</em> zwischen den KÃ¶rpern. Jedes Paar besteht aus gleich groÃŸen, entgegengesetzten KrÃ¤ften auf <em>verschiedenen</em> KÃ¶rpern.';
    } else {
        const info = {
            buch: 'Auf das <strong>Buch</strong> wirken 2 KrÃ¤fte: Gewichtskraft Fâƒ—<sub>G</sub> (nach unten) und Normalkraft Fâƒ—<sub>N</sub> (nach oben). Da beide gleich groÃŸ sind: Fâƒ—<sub>res</sub> = 0 â†’ Gleichgewicht.',
            tisch: 'Auf den <strong>Tisch</strong> wirken 3 KrÃ¤fte: Seine eigene Gewichtskraft, die Druckkraft vom Buch und die Normalkraft vom Boden.',
            erde: 'Das Buch zieht die <strong>Erde</strong> mit einer winzigen Gravitationskraft an (Newton III!). Wegen der riesigen Masse der Erde ist die Wirkung vernachlÃ¤ssigbar.'
        };
        el.innerHTML = '<strong>FKB: ' + fkbSelectedBody.charAt(0).toUpperCase() + fkbSelectedBody.slice(1) + '</strong> â€” ' + info[fkbSelectedBody];
    }
}

function checkFKBQuiz() {
    const sel = document.querySelector('input[name="fkb-q"]:checked');
    const fb = document.getElementById('fb-fkb-q');
    if (!sel) { fb.className = 'feedback hint'; fb.innerHTML = 'Bitte wÃ¤hle eine Antwort.'; return; }
    if (sel.value === '2') {
        fb.className = 'feedback correct';
        fb.innerHTML = 'âœ“ Richtig! Auf das Buch wirken genau 2 KrÃ¤fte: Gewichtskraft (â†“) und Normalkraft (â†‘). Die GegenkrÃ¤fte (Buch drÃ¼ckt Tisch, Buch zieht Erde) wirken auf andere KÃ¶rper!';
    } else {
        fb.className = 'feedback incorrect';
        fb.innerHTML = 'âœ— Nicht ganz. Wechsle in die FKB-Ansicht und wÃ¤hle "Buch" â€“ wie viele Pfeile zeigen auf das Buch?';
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 3: F_RES SZENARIEN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let fresCanvas, fresCtx, currentFresScenario = 0;
let fresSolved = [false, false, false];

function initFresCanvas() {
    fresCanvas = document.getElementById('fresCanvas');
    if (!fresCanvas) return;
    fresCtx = fresCanvas.getContext('2d');
    drawFresScenario();
}

function showFresScenario(idx) {
    currentFresScenario = idx;
    document.querySelectorAll('.scenario-tab').forEach((t, i) => t.classList.toggle('active', i === idx));
    for (let i = 0; i < 3; i++) {
        document.getElementById('fres-exercise-' + i).style.display = i === idx ? 'block' : 'none';
    }
    drawFresScenario();
}

function drawFresScenario() {
    if (!fresCtx) return;
    const ctx = fresCtx, w = fresCanvas.width, h = fresCanvas.height;
    ctx.clearRect(0, 0, w, h);
    ctx.fillStyle = '#fafafa'; ctx.fillRect(0, 0, w, h);

    const cx = w/2, cy = h/2;

    if (currentFresScenario === 0) {
        // Buch auf Tisch
        ctx.fillStyle = '#a1887f'; ctx.fillRect(cx - 80, cy + 20, 160, 10);
        ctx.fillStyle = '#42a5f5'; ctx.fillRect(cx - 35, cy - 10, 70, 30);
        ctx.fillStyle = 'white'; ctx.font = 'bold 12px sans-serif'; ctx.textAlign = 'center';
        ctx.fillText('Buch', cx, cy + 10);
        drawArrow(ctx, cx - 20, cy + 20, cx - 20, cy + 80, '#c62828', 4);
        ctx.fillStyle = '#c62828'; ctx.font = 'italic 13px sans-serif'; ctx.textAlign = 'left';
        ctx.fillText('FG = 5 N', cx - 10, cy + 60);
        drawArrow(ctx, cx + 20, cy - 10, cx + 20, cy - 70, '#2e7d32', 4);
        ctx.fillStyle = '#2e7d32';
        ctx.fillText('FN = 5 N', cx + 30, cy - 40);
        if (fresSolved[0]) {
            ctx.fillStyle = '#9c27b0'; ctx.font = 'bold 16px sans-serif'; ctx.textAlign = 'center';
            ctx.fillText('Fres = 0 N âœ“', cx, 30);
        }
    } else if (currentFresScenario === 1) {
        // Fallender Apfel
        ctx.fillStyle = '#e53935'; ctx.beginPath(); ctx.arc(cx, cy, 20, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = 'white'; ctx.font = 'bold 12px sans-serif'; ctx.textAlign = 'center';
        ctx.fillText('ğŸ', cx, cy + 6);
        drawArrow(ctx, cx, cy + 20, cx, cy + 100, '#c62828', 4);
        ctx.fillStyle = '#c62828'; ctx.font = 'italic 13px sans-serif'; ctx.textAlign = 'left';
        ctx.fillText('FG = 1 N', cx + 10, cy + 70);
        if (fresSolved[1]) {
            drawArrow(ctx, cx + 60, cy, cx + 60, cy + 80, '#9c27b0', 5);
            ctx.fillStyle = '#9c27b0'; ctx.font = 'bold 14px sans-serif'; ctx.textAlign = 'center';
            ctx.fillText('Fres = 1 N â†“ âœ“', cx, 30);
        }
    } else {
        // Rakete
        ctx.fillStyle = '#eceff1';
        ctx.beginPath(); ctx.moveTo(cx, cy - 50); ctx.lineTo(cx + 20, cy + 30); ctx.lineTo(cx - 20, cy + 30); ctx.closePath(); ctx.fill();
        ctx.fillStyle = '#f44336';
        ctx.beginPath(); ctx.moveTo(cx, cy - 50); ctx.lineTo(cx + 12, cy - 25); ctx.lineTo(cx - 12, cy - 25); ctx.closePath(); ctx.fill();
        drawArrow(ctx, cx - 40, cy, cx - 40, cy + 90, '#c62828', 4);
        ctx.fillStyle = '#c62828'; ctx.font = 'italic 12px sans-serif'; ctx.textAlign = 'left';
        ctx.fillText('FG = 30.000 kN', cx - 35, cy + 55);
        drawArrow(ctx, cx + 40, cy, cx + 40, cy - 90, '#2e7d32', 4);
        ctx.fillStyle = '#2e7d32';
        ctx.fillText('FSchub = 35.000 kN', cx + 50, cy - 45);
        if (fresSolved[2]) {
            drawArrow(ctx, cx + 100, cy, cx + 100, cy - 40, '#9c27b0', 5);
            ctx.fillStyle = '#9c27b0'; ctx.font = 'bold 14px sans-serif'; ctx.textAlign = 'center';
            ctx.fillText('Fres = 5.000 kN â†‘ âœ“', cx, 30);
        }
    }
    ctx.textAlign = 'left';
}

function checkFres(idx) {
    const fb = document.getElementById('fb-fres' + idx);
    if (idx === 0) {
        const v = document.getElementById('fres1').value.trim();
        if (v === '0' || v === '0 N' || v === '0N') {
            fb.className = 'feedback correct';
            fb.innerHTML = 'âœ“ Richtig! 5 N âˆ’ 5 N = 0 N. Das Buch ist im Gleichgewicht.';
            fresSolved[0] = true;
        } else {
            fb.className = 'feedback incorrect';
            fb.innerHTML = 'âœ— Addiere: 5 N nach unten + 5 N nach oben = ?';
            return;
        }
    } else if (idx === 1) {
        const v = document.getElementById('fres2').value.trim();
        const d = document.getElementById('fres2dir').value;
        if ((v === '1' || v === '1 N' || v === '1N') && d === 'unten') {
            fb.className = 'feedback correct';
            fb.innerHTML = 'âœ“ Richtig! Nur FG wirkt â†’ Fres = 1 N nach unten. Der Apfel fÃ¤llt.';
            fresSolved[1] = true;
        } else {
            fb.className = 'feedback incorrect';
            fb.innerHTML = 'âœ— Nur die Gewichtskraft wirkt. Fres = FG. Richtung?';
            return;
        }
    } else {
        const v = document.getElementById('fres3').value.trim().replace(/\s/g, '').replace(/\./g, '').replace(',', '');
        const d = document.getElementById('fres3dir').value;
        if ((v === '5000' || v === '5000kN') && d === 'oben') {
            fb.className = 'feedback correct';
            fb.innerHTML = 'âœ“ Richtig! 35.000 âˆ’ 30.000 = 5.000 kN nach oben. Die Rakete hebt ab!';
            fresSolved[2] = true;
        } else {
            fb.className = 'feedback incorrect';
            fb.innerHTML = 'âœ— Rechne: 35.000 kN (â†‘) âˆ’ 30.000 kN (â†“) = ?';
            return;
        }
    }
    drawFresScenario();
    if (fresSolved[0] && fresSolved[1] && fresSolved[2]) {
        document.getElementById('fres-erkenntnis').style.display = 'block';
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 4: BUS-SIMULATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let busCanvas, busCtx;
let busState = 'idle'; // 'idle', 'driving', 'braking'
let busX = 100, busSpeed = 0, personTilt = 0;
let busAnimId = null;

function initBus() {
    busCanvas = document.getElementById('busCanvas');
    if (!busCanvas) return;
    busCtx = busCanvas.getContext('2d');
    drawBus();
}

function drawBus() {
    if (!busCtx) return;
    const ctx = busCtx, w = busCanvas.width, h = busCanvas.height;
    ctx.clearRect(0, 0, w, h);

    // Himmel
    ctx.fillStyle = '#e3f2fd'; ctx.fillRect(0, 0, w, h - 60);
    // StraÃŸe
    ctx.fillStyle = '#616161'; ctx.fillRect(0, h - 60, w, 60);
    ctx.setLineDash([20, 15]);
    ctx.strokeStyle = '#fff'; ctx.lineWidth = 3;
    ctx.beginPath(); ctx.moveTo(0, h - 30); ctx.lineTo(w, h - 30); ctx.stroke();
    ctx.setLineDash([]);

    // BÃ¤ume/HÃ¤user (Hintergrund, bewegen sich relativ)
    const bgOffset = -busX * 0.3;
    for (let i = 0; i < 5; i++) {
        const tx = ((i * 200 + bgOffset) % (w + 200)) - 100;
        ctx.fillStyle = '#4caf50';
        ctx.beginPath(); ctx.moveTo(tx, h - 80); ctx.lineTo(tx + 20, h - 130); ctx.lineTo(tx + 40, h - 80); ctx.closePath(); ctx.fill();
        ctx.fillStyle = '#795548'; ctx.fillRect(tx + 15, h - 80, 10, 20);
    }

    // Bus
    const bx = w/2 - 80;
    const by = h - 130;
    ctx.fillStyle = '#ffc107'; ctx.fillRect(bx, by, 160, 70);
    // Fenster
    ctx.fillStyle = '#bbdefb';
    ctx.fillRect(bx + 10, by + 10, 30, 25);
    ctx.fillRect(bx + 50, by + 10, 30, 25);
    ctx.fillRect(bx + 90, by + 10, 30, 25);
    ctx.fillRect(bx + 130, by + 10, 20, 25);
    // RÃ¤der
    ctx.fillStyle = '#333';
    ctx.beginPath(); ctx.arc(bx + 30, by + 70, 12, 0, Math.PI * 2); ctx.fill();
    ctx.beginPath(); ctx.arc(bx + 130, by + 70, 12, 0, Math.PI * 2); ctx.fill();

    // Person im Bus
    const px = bx + 80, py = by + 55;
    ctx.save();
    ctx.translate(px, py);
    ctx.rotate(personTilt * Math.PI / 180);
    // Kopf
    ctx.fillStyle = '#ffcc80';
    ctx.beginPath(); ctx.arc(0, -35, 8, 0, Math.PI * 2); ctx.fill();
    // KÃ¶rper
    ctx.strokeStyle = '#333'; ctx.lineWidth = 3;
    ctx.beginPath(); ctx.moveTo(0, -27); ctx.lineTo(0, -5); ctx.stroke();
    // Beine
    ctx.beginPath(); ctx.moveTo(0, -5); ctx.lineTo(-6, 10); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(0, -5); ctx.lineTo(6, 10); ctx.stroke();
    // Arme
    ctx.beginPath(); ctx.moveTo(0, -20); ctx.lineTo(-10, -10); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(0, -20); ctx.lineTo(10, -10); ctx.stroke();
    ctx.restore();

    // Geschwindigkeitsanzeige
    ctx.fillStyle = '#333'; ctx.font = '14px sans-serif'; ctx.textAlign = 'left';
    ctx.fillText('v = ' + Math.abs(busSpeed * 10).toFixed(0) + ' km/h', 15, 25);

    // Status
    const statusText = { idle: 'Bereit', driving: 'GleichmÃ¤ÃŸige Fahrt', braking: 'Bremsung!' };
    ctx.fillStyle = busState === 'braking' ? '#c62828' : '#333';
    ctx.font = 'bold 14px sans-serif'; ctx.textAlign = 'right';
    ctx.fillText(statusText[busState], w - 15, 25);
}

function startBus() {
    if (busState !== 'idle') return;
    busState = 'driving'; busSpeed = 3;
    document.getElementById('busBtn').disabled = true;
    document.getElementById('brakeBtn').disabled = false;
    animateBus();
}

function brakeBus() {
    if (busState !== 'driving') return;
    busState = 'braking';
    document.getElementById('brakeBtn').disabled = true;
}

function animateBus() {
    if (busState === 'driving') {
        busX += busSpeed;
        personTilt = 0;
    } else if (busState === 'braking') {
        busSpeed *= 0.96;
        personTilt = Math.min(personTilt + 0.8, 25);
        if (busSpeed < 0.1) { busSpeed = 0; busState = 'stopped'; }
    }
    drawBus();
    if (busState === 'driving' || busState === 'braking') {
        busAnimId = requestAnimationFrame(animateBus);
    }
}

function resetBus() {
    busState = 'idle'; busX = 100; busSpeed = 0; personTilt = 0;
    if (busAnimId) cancelAnimationFrame(busAnimId);
    document.getElementById('busBtn').disabled = false;
    document.getElementById('brakeBtn').disabled = true;
    drawBus();
}

function checkBusQ() {
    const sel = document.querySelector('input[name="bus-q"]:checked');
    const fb = document.getElementById('fb-bus-q');
    if (!sel) { fb.className = 'feedback hint'; fb.innerHTML = 'Bitte wÃ¤hle eine Antwort.'; return; }
    if (sel.value === 'a') {
        fb.className = 'feedback correct';
        fb.innerHTML = 'âœ“ Richtig! Die Person ist trÃ¤ge â€“ ihr KÃ¶rper bewegt sich mit der ursprÃ¼nglichen Geschwindigkeit weiter, wÃ¤hrend der Bus unter ihr abbremst.';
    } else {
        fb.className = 'feedback incorrect';
        fb.innerHTML = 'âœ— Probiere die Simulation aus und beobachte genau.';
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 4: MÃœNZE-AUF-PAPPE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let coinCanvas, coinCtx;
let coinState = 'ready'; // 'ready', 'pulling', 'falling', 'done'
let cardX = 0, coinY = 0, coinFallV = 0;
let coinAnimId = null;

function initCoin() {
    coinCanvas = document.getElementById('coinCanvas');
    if (!coinCanvas) return;
    coinCtx = coinCanvas.getContext('2d');
    resetCoin();
}

function drawCoin() {
    if (!coinCtx) return;
    const ctx = coinCtx, w = coinCanvas.width, h = coinCanvas.height;
    ctx.clearRect(0, 0, w, h);

    // Hintergrund
    ctx.fillStyle = '#fff8e1'; ctx.fillRect(0, 0, w, h);

    // Tisch
    const tischY = h * 0.7;
    ctx.fillStyle = '#8d6e63'; ctx.fillRect(0, tischY, w, h - tischY);
    ctx.fillStyle = '#6d4c41'; ctx.fillRect(0, tischY, w, 5);

    // Glas (auf dem Tisch, unter der MÃ¼nze)
    const glasX = w/2;
    ctx.strokeStyle = '#90caf9'; ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(glasX - 18, tischY);
    ctx.lineTo(glasX - 15, tischY - 40);
    ctx.lineTo(glasX + 15, tischY - 40);
    ctx.lineTo(glasX + 18, tischY);
    ctx.stroke();

    // Pappe
    if (coinState !== 'done') {
        ctx.fillStyle = '#bcaaa4';
        ctx.fillRect(glasX - 40 + cardX, tischY - 45, 80, 5);
    }

    // MÃ¼nze
    const coinDrawY = tischY - 50 + coinY;
    ctx.fillStyle = '#ffd54f'; ctx.strokeStyle = '#f9a825'; ctx.lineWidth = 2;
    ctx.beginPath(); ctx.arc(glasX, coinDrawY, 12, 0, Math.PI * 2); ctx.fill(); ctx.stroke();
    ctx.fillStyle = '#f57f17'; ctx.font = 'bold 10px sans-serif'; ctx.textAlign = 'center';
    ctx.fillText('1â‚¬', glasX, coinDrawY + 4);

    // Beschriftungen
    ctx.fillStyle = '#333'; ctx.font = '13px sans-serif';
    if (coinState === 'ready') {
        ctx.fillText('Pappe mit MÃ¼nze auf dem Glas', glasX, 25);
    } else if (coinState === 'pulling' || coinState === 'falling') {
        ctx.fillText('Pappe wird weggezogen â†’ MÃ¼nze bleibt!', glasX, 25);
    } else {
        ctx.fillStyle = '#2e7d32'; ctx.font = 'bold 14px sans-serif';
        ctx.fillText('TrÃ¤gheit: Die MÃ¼nze blieb an Ort und Stelle!', glasX, 25);
    }
    ctx.textAlign = 'left';
}

function pullCard() {
    if (coinState !== 'ready') return;
    coinState = 'pulling';
    animateCoin();
}

function animateCoin() {
    if (coinState === 'pulling') {
        cardX += 15;
        if (cardX > 200) {
            coinState = 'falling';
            coinFallV = 0;
        }
    } else if (coinState === 'falling') {
        coinFallV += 0.5;
        coinY += coinFallV;
        if (coinY > 10) {
            coinState = 'done';
            coinY = 10;
        }
    }
    drawCoin();
    if (coinState !== 'done' && coinState !== 'ready') {
        coinAnimId = requestAnimationFrame(animateCoin);
    }
}

function resetCoin() {
    coinState = 'ready'; cardX = 0; coinY = 0; coinFallV = 0;
    if (coinAnimId) cancelAnimationFrame(coinAnimId);
    drawCoin();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 5: DRAG & DROP IS-ZUORDNUNG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let draggedItem = null;

function initDragDrop() {
    const items = document.querySelectorAll('.is-item');
    const cols = document.querySelectorAll('.is-column');

    items.forEach(item => {
        // Touch events
        item.addEventListener('touchstart', function(e) {
            e.preventDefault();
            draggedItem = this;
            this.classList.add('dragging');
        }, { passive: false });

        // Mouse events
        item.addEventListener('dragstart', function(e) {
            draggedItem = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        });
        item.addEventListener('dragend', function() {
            this.classList.remove('dragging');
            draggedItem = null;
        });
    });

    cols.forEach(col => {
        col.addEventListener('dragover', function(e) { e.preventDefault(); });
        col.addEventListener('drop', function(e) {
            e.preventDefault();
            if (draggedItem) {
                this.appendChild(draggedItem);
                draggedItem.classList.remove('dragging');
                draggedItem = null;
            }
        });

        // Touch drop
        col.addEventListener('touchmove', function(e) { e.preventDefault(); }, { passive: false });
    });

    // Touch end - find column under finger
    document.addEventListener('touchend', function(e) {
        if (!draggedItem) return;
        draggedItem.classList.remove('dragging');
        const touch = e.changedTouches[0];
        const target = document.elementFromPoint(touch.clientX, touch.clientY);
        const col = target && target.closest('.is-column');
        if (col) {
            col.appendChild(draggedItem);
        }
        draggedItem = null;
    });
}

function checkIS() {
    const jaCol = document.getElementById('is-ja-col');
    const neinCol = document.getElementById('is-nein-col');
    const fb = document.getElementById('fb-is');
    let correct = 0;

    jaCol.querySelectorAll('.is-item').forEach(item => {
        if (item.dataset.is === 'ja') { correct++; item.classList.add('correct-placed'); item.classList.remove('wrong-placed'); }
        else { item.classList.add('wrong-placed'); item.classList.remove('correct-placed'); }
    });
    neinCol.querySelectorAll('.is-item').forEach(item => {
        if (item.dataset.is === 'nein') { correct++; item.classList.add('correct-placed'); item.classList.remove('wrong-placed'); }
        else { item.classList.add('wrong-placed'); item.classList.remove('correct-placed'); }
    });

    // Items still in source
    const sourceItems = document.getElementById('is-source').querySelectorAll('.is-item');
    const total = 4;
    const placed = total - sourceItems.length;

    if (placed < total) {
        fb.className = 'feedback hint';
        fb.innerHTML = 'Ziehe alle Karten in eine der beiden Spalten.';
        return;
    }

    if (correct === total) {
        fb.className = 'feedback correct';
        fb.innerHTML = 'âœ“ Alle richtig zugeordnet!';
    } else {
        fb.className = 'feedback incorrect';
        fb.innerHTML = correct + '/' + total + ' richtig. Die rot markierten sind falsch zugeordnet.';
    }
    document.getElementById('is-explanations').style.display = 'block';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCHRITT 6: ABSCHLUSSQUIZ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function checkFinalQuiz() {
    let correct = 0;
    const answers = [
        ['q6-1', 'b'], ['q6-2', 'a'], ['q6-3', 'b'], ['q6-4', 'c'], ['q6-5', 'b']
    ];
    answers.forEach(([name, val]) => {
        const sel = document.querySelector('input[name="' + name + '"]:checked');
        if (sel && sel.value === val) correct++;
    });
    const fb = document.getElementById('fb-final');
    if (correct === 5) {
        fb.className = 'feedback correct';
        fb.innerHTML = 'âœ“ Ausgezeichnet! ' + correct + '/5 richtig. Du hast alles verstanden!';
    } else if (correct >= 3) {
        fb.className = 'feedback hint';
        fb.innerHTML = correct + '/5 richtig. Schau dir die Zusammenfassung oben noch einmal an.';
    } else {
        fb.className = 'feedback incorrect';
        fb.innerHTML = correct + '/5 richtig. Lies die MerksÃ¤tze noch einmal durch.';
    }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ABSCHLUSS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function finish() {
    localStorage.setItem(LP_ID + '-completed', 'true');
    localStorage.setItem(LP_ID + '-completedAt', new Date().toISOString());
    alert('Lernpfad abgeschlossen! Vergiss nicht, dein Arbeitsblatt abzugeben.');
}

window.onload = init;
</script>
</body>
</html>
