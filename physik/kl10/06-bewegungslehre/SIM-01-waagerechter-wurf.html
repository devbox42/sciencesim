<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waagerechter Wurf – Simulation</title>
    <style>
        :root {
            --bg: #f5f5f5;
            --white: #ffffff;
            --border: #dddddd;
            --text-primary: #222222;
            --text-secondary: #555555;
            --text-muted: #888888;
            --physik: #2c5aa0;
            --physik-light: #e8f0fa;
            --ball-fall: #1565c0;
            --ball-wurf: #c62828;
            --vector-vx: #c62828;
            --vector-vy: #1565c0;
            --vector-vres: #2a7a4b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            font-size: 0.9em;
            background: var(--bg);
            color: var(--text-primary);
            line-height: 1.5;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 15px;
        }

        h1 {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--physik);
        }

        .sim-layout {
            display: grid;
            grid-template-columns: 1fr 260px;
            gap: 15px;
        }

        .canvas-wrapper {
            background: var(--white);
            border: 1px solid var(--border);
            padding: 10px;
        }

        canvas {
            display: block;
            width: 100%;
            background: #fafafa;
        }

        .controls {
            background: var(--white);
            border: 1px solid var(--border);
            padding: 12px;
            font-size: 0.85em;
        }

        .control-section {
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .control-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .control-section h3 {
            font-size: 0.8em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .control-row {
            margin-bottom: 10px;
        }

        .control-row label {
            display: block;
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }

        .control-row .value {
            font-family: "SF Mono", Monaco, monospace;
            color: var(--physik);
            font-weight: 600;
        }

        input[type="range"] {
            width: 100%;
            margin: 4px 0;
        }

        .btn-row {
            display: flex;
            gap: 6px;
        }

        .btn {
            flex: 1;
            padding: 8px 12px;
            background: var(--physik);
            color: white;
            border: none;
            font-size: 0.85em;
            cursor: pointer;
        }

        .btn:hover { opacity: 0.9; }

        .btn-secondary {
            background: var(--white);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .results {
            background: var(--physik-light);
            padding: 10px;
            margin-top: 10px;
        }

        .results h3 {
            font-size: 0.8em;
            color: var(--physik);
            margin-bottom: 8px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
        }

        .result-item {
            font-size: 0.8em;
        }

        .result-item .label {
            color: var(--text-muted);
        }

        .result-item .val {
            font-family: "SF Mono", Monaco, monospace;
            font-weight: 600;
        }

        .result-item.highlight {
            grid-column: 1 / -1;
            background: var(--white);
            padding: 6px;
            margin-top: 4px;
        }

        .result-item.highlight .val {
            color: var(--vector-vres);
        }

        .checkbox-group {
            margin-top: 10px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8em;
            cursor: pointer;
            margin-bottom: 4px;
        }

        .legend {
            margin-top: 10px;
            font-size: 0.75em;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 3px;
        }

        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .legend-line {
            width: 16px;
            height: 3px;
        }

        .message {
            margin-top: 10px;
            padding: 8px;
            background: #e8f5e9;
            border: 1px solid #4caf50;
            font-size: 0.8em;
            display: none;
        }

        .message.show { display: block; }

        @media (max-width: 700px) {
            .sim-layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Waagerechter Wurf / Horizontal Projectile Motion</h1>

        <div class="sim-layout">
            <div class="canvas-wrapper">
                <canvas id="canvas" width="580" height="420"></canvas>
            </div>

            <div class="controls">
                <div class="control-section">
                    <h3>Parameter</h3>
                    <div class="control-row">
                        <label>Höhe h₀ / Height</label>
                        <span class="value" id="heightVal">20 m</span>
                        <input type="range" id="heightSlider" min="5" max="80" value="20" step="5">
                    </div>
                    <div class="control-row">
                        <label>Geschwindigkeit v₀ / Velocity</label>
                        <span class="value" id="velocityVal">20 m/s</span>
                        <input type="range" id="velocitySlider" min="5" max="40" value="20" step="5">
                    </div>
                </div>

                <div class="control-section">
                    <h3>Steuerung / Control</h3>
                    <div class="btn-row">
                        <button class="btn" id="startBtn">▶ Start</button>
                        <button class="btn btn-secondary" id="resetBtn">↺ Reset</button>
                    </div>
                </div>

                <div class="control-section">
                    <h3>Anzeige / Display</h3>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="showComparison" checked> Vergleichsball / Comparison ball</label>
                        <label><input type="checkbox" id="showVectors" checked> Geschwindigkeitsvektoren / Velocity vectors</label>
                        <label><input type="checkbox" id="showStroboscope"> Stroboskop / Stroboscope</label>
                        <label><input type="checkbox" id="showAngle" checked> Auftreffwinkel / Impact angle</label>
                    </div>
                </div>

                <div class="results">
                    <h3>Ergebnisse / Results</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <span class="label">Zeit t:</span>
                            <span class="val" id="resTime">– s</span>
                        </div>
                        <div class="result-item">
                            <span class="label">Weite s_x:</span>
                            <span class="val" id="resRange">– m</span>
                        </div>
                        <div class="result-item">
                            <span class="label">v_x:</span>
                            <span class="val" id="resVx">– m/s</span>
                        </div>
                        <div class="result-item">
                            <span class="label">v_y:</span>
                            <span class="val" id="resVy">– m/s</span>
                        </div>
                        <div class="result-item highlight">
                            <span class="label">v_res = √(v_x² + v_y²):</span>
                            <span class="val" id="resVres">– m/s</span>
                        </div>
                        <div class="result-item highlight">
                            <span class="label">Winkel α:</span>
                            <span class="val" id="resAngle">– °</span>
                        </div>
                    </div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot" style="background: var(--ball-fall);"></div>
                        <span>Fallball / Falling ball</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background: var(--ball-wurf);"></div>
                        <span>Wurfball / Thrown ball</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-line" style="background: var(--vector-vres);"></div>
                        <span>v_res (resultierend)</span>
                    </div>
                </div>

                <div class="message" id="message">
                    <strong>Beobachtung:</strong> Beide Bälle landen gleichzeitig!<br>
                    <strong>Observation:</strong> Both balls land at the same time!
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Physics
        const g = 10; // m/s² (approximation for easier calculation)

        // State
        let h0 = 20, v0 = 20;
        let isRunning = false, animationId = null, currentTime = 0;
        let strobePositions = [];

        // Scale
        const scale = 4.2;
        const originX = 70, groundY = 400;

        // Elements
        const heightSlider = document.getElementById('heightSlider');
        const velocitySlider = document.getElementById('velocitySlider');
        const heightVal = document.getElementById('heightVal');
        const velocityVal = document.getElementById('velocityVal');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const showComparison = document.getElementById('showComparison');
        const showVectors = document.getElementById('showVectors');
        const showStroboscope = document.getElementById('showStroboscope');
        const showAngle = document.getElementById('showAngle');
        const message = document.getElementById('message');

        function toCanvas(x, y) {
            return { cx: originX + x * scale, cy: groundY - y * scale };
        }

        function drawBackground() {
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Ground
            ctx.fillStyle = '#e8e8e8';
            ctx.fillRect(0, groundY, canvas.width, 20);
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, groundY);
            ctx.lineTo(canvas.width, groundY);
            ctx.stroke();

            // Platform
            const platY = toCanvas(0, h0).cy;
            ctx.fillStyle = '#666';
            ctx.fillRect(0, platY - 3, originX + 5, 6);

            // Height marker
            ctx.strokeStyle = '#bbb';
            ctx.lineWidth = 1;
            ctx.setLineDash([4, 4]);
            ctx.beginPath();
            ctx.moveTo(35, platY);
            ctx.lineTo(35, groundY);
            ctx.stroke();
            ctx.setLineDash([]);

            ctx.fillStyle = '#666';
            ctx.font = '11px -apple-system, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('h=' + h0 + 'm', 35, (platY + groundY) / 2 + 4);

            // Scale
            ctx.fillStyle = '#999';
            ctx.font = '9px -apple-system, sans-serif';
            for (let x = 0; x <= 120; x += 20) {
                const pos = toCanvas(x, 0);
                if (pos.cx < canvas.width - 20) {
                    ctx.fillText(x + 'm', pos.cx, groundY + 14);
                }
            }
        }

        function drawStroboscope() {
            if (!showStroboscope.checked || strobePositions.length === 0) return;

            strobePositions.forEach((pos, i) => {
                const alpha = 0.2 + (i / strobePositions.length) * 0.5;

                if (showComparison.checked) {
                    const fallPos = toCanvas(0, h0 - pos.y);
                    ctx.fillStyle = `rgba(21, 101, 192, ${alpha})`;
                    ctx.beginPath();
                    ctx.arc(originX, fallPos.cy, 6, 0, Math.PI * 2);
                    ctx.fill();
                }

                const throwPos = toCanvas(pos.x, h0 - pos.y);
                ctx.fillStyle = `rgba(198, 40, 40, ${alpha})`;
                ctx.beginPath();
                ctx.arc(throwPos.cx, throwPos.cy, 6, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function drawTrajectory(t) {
            const steps = 60;
            const fallTime = Math.sqrt(2 * h0 / g);
            const maxT = Math.min(t, fallTime);

            // Parabola trace
            ctx.strokeStyle = 'rgba(198, 40, 40, 0.3)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            for (let i = 0; i <= steps; i++) {
                const tt = (maxT * i) / steps;
                const x = v0 * tt;
                const y = h0 - 0.5 * g * tt * tt;
                const pos = toCanvas(x, y);
                if (i === 0) ctx.moveTo(pos.cx, pos.cy);
                else ctx.lineTo(pos.cx, pos.cy);
            }
            ctx.stroke();

            // Fall line
            if (showComparison.checked) {
                const yDrop = 0.5 * g * maxT * maxT;
                ctx.strokeStyle = 'rgba(21, 101, 192, 0.3)';
                ctx.beginPath();
                ctx.moveTo(originX, toCanvas(0, h0).cy);
                ctx.lineTo(originX, toCanvas(0, h0 - yDrop).cy);
                ctx.stroke();
            }
        }

        function drawVectors(x, y, vy) {
            if (!showVectors.checked) return;

            const pos = toCanvas(x, h0 - y);
            const vScale = 1.2;

            // v_x (red, horizontal)
            ctx.strokeStyle = '#c62828';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(pos.cx, pos.cy);
            ctx.lineTo(pos.cx + v0 * vScale, pos.cy);
            ctx.stroke();
            drawArrowHead(pos.cx + v0 * vScale, pos.cy, 0, '#c62828');

            // v_y (blue, down)
            ctx.strokeStyle = '#1565c0';
            ctx.beginPath();
            ctx.moveTo(pos.cx, pos.cy);
            ctx.lineTo(pos.cx, pos.cy + vy * vScale);
            ctx.stroke();
            drawArrowHead(pos.cx, pos.cy + vy * vScale, 90, '#1565c0');

            // v_res (green, diagonal)
            const vres = Math.sqrt(v0 * v0 + vy * vy);
            const angle = Math.atan2(vy, v0);
            ctx.strokeStyle = '#2a7a4b';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(pos.cx, pos.cy);
            ctx.lineTo(pos.cx + vres * vScale * Math.cos(angle), pos.cy + vres * vScale * Math.sin(angle));
            ctx.stroke();
            drawArrowHead(
                pos.cx + vres * vScale * Math.cos(angle),
                pos.cy + vres * vScale * Math.sin(angle),
                angle * 180 / Math.PI,
                '#2a7a4b'
            );

            // Labels
            ctx.font = '10px -apple-system, sans-serif';
            ctx.fillStyle = '#c62828';
            ctx.fillText('v_x', pos.cx + v0 * vScale / 2, pos.cy - 6);
            ctx.fillStyle = '#1565c0';
            ctx.fillText('v_y', pos.cx + 8, pos.cy + vy * vScale / 2);
            ctx.fillStyle = '#2a7a4b';
            ctx.fillText('v_res', pos.cx + vres * vScale * 0.5 * Math.cos(angle) + 8,
                                  pos.cy + vres * vScale * 0.5 * Math.sin(angle) - 6);
        }

        function drawArrowHead(x, y, angleDeg, color) {
            const size = 6;
            const angle = angleDeg * Math.PI / 180;
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x - size * Math.cos(angle - 0.4), y - size * Math.sin(angle - 0.4));
            ctx.lineTo(x - size * Math.cos(angle + 0.4), y - size * Math.sin(angle + 0.4));
            ctx.closePath();
            ctx.fill();
        }

        function drawAngleArc(x, y, vy) {
            if (!showAngle.checked || vy < 2) return;

            const pos = toCanvas(x, h0 - y);
            const angle = Math.atan2(vy, v0);
            const radius = 25;

            ctx.strokeStyle = '#2a7a4b';
            ctx.lineWidth = 1.5;
            ctx.beginPath();
            ctx.arc(pos.cx, pos.cy, radius, 0, angle);
            ctx.stroke();

            // Angle label
            const labelAngle = angle / 2;
            ctx.fillStyle = '#2a7a4b';
            ctx.font = 'bold 11px -apple-system, sans-serif';
            ctx.fillText('α', pos.cx + (radius + 10) * Math.cos(labelAngle),
                              pos.cy + (radius + 10) * Math.sin(labelAngle) + 4);
        }

        function drawBalls(t) {
            const fallTime = Math.sqrt(2 * h0 / g);
            const clampedT = Math.min(t, fallTime);
            const y = 0.5 * g * clampedT * clampedT;
            const x = v0 * clampedT;
            const vy = g * clampedT;

            // Comparison ball (blue, falling)
            if (showComparison.checked) {
                const fallPos = toCanvas(0, h0 - y);
                ctx.fillStyle = '#1565c0';
                ctx.beginPath();
                ctx.arc(originX, fallPos.cy, 10, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(255,255,255,0.3)';
                ctx.beginPath();
                ctx.arc(originX - 3, fallPos.cy - 3, 3, 0, Math.PI * 2);
                ctx.fill();
            }

            // Main ball (red, thrown)
            const throwPos = toCanvas(x, h0 - y);
            ctx.fillStyle = '#c62828';
            ctx.beginPath();
            ctx.arc(throwPos.cx, throwPos.cy, 10, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            ctx.beginPath();
            ctx.arc(throwPos.cx - 3, throwPos.cy - 3, 3, 0, Math.PI * 2);
            ctx.fill();

            // Connection line
            if (showComparison.checked && t < fallTime) {
                ctx.strokeStyle = '#ccc';
                ctx.lineWidth = 1;
                ctx.setLineDash([3, 3]);
                ctx.beginPath();
                ctx.moveTo(originX, toCanvas(0, h0 - y).cy);
                ctx.lineTo(throwPos.cx, throwPos.cy);
                ctx.stroke();
                ctx.setLineDash([]);
            }

            drawVectors(x, y, vy);
            drawAngleArc(x, y, vy);
        }

        function updateResults(t, finished = false) {
            const fallTime = Math.sqrt(2 * h0 / g);
            const displayT = finished ? fallTime : t;
            const vy = g * displayT;
            const vres = Math.sqrt(v0 * v0 + vy * vy);
            const angle = Math.atan2(vy, v0) * 180 / Math.PI;
            const range = v0 * fallTime;

            document.getElementById('resTime').textContent = displayT.toFixed(2) + ' s';
            document.getElementById('resRange').textContent = (v0 * displayT).toFixed(1) + ' m';
            document.getElementById('resVx').textContent = v0.toFixed(1) + ' m/s';
            document.getElementById('resVy').textContent = vy.toFixed(1) + ' m/s';
            document.getElementById('resVres').textContent = vres.toFixed(1) + ' m/s';
            document.getElementById('resAngle').textContent = angle.toFixed(1) + '°';

            if (finished) {
                message.classList.add('show');
            }
        }

        function draw() {
            drawBackground();
            drawStroboscope();
            drawTrajectory(currentTime);
            drawBalls(currentTime);
            updateResults(currentTime);
        }

        function animate() {
            const fallTime = Math.sqrt(2 * h0 / g);

            if (currentTime < fallTime) {
                currentTime += 0.025;

                // Stroboscope
                if (showStroboscope.checked) {
                    const interval = 0.4;
                    const lastStrobe = strobePositions.length * interval;
                    if (currentTime >= lastStrobe + interval) {
                        const t = lastStrobe + interval;
                        strobePositions.push({
                            x: v0 * t,
                            y: 0.5 * g * t * t
                        });
                    }
                }

                draw();
                animationId = requestAnimationFrame(animate);
            } else {
                currentTime = fallTime;
                draw();
                updateResults(currentTime, true);
                isRunning = false;
                startBtn.textContent = '▶ Start';
            }
        }

        function start() {
            if (isRunning) {
                isRunning = false;
                cancelAnimationFrame(animationId);
                startBtn.textContent = '▶ Start';
            } else {
                const fallTime = Math.sqrt(2 * h0 / g);
                if (currentTime >= fallTime) reset();
                isRunning = true;
                startBtn.textContent = '⏸ Pause';
                animate();
            }
        }

        function reset() {
            isRunning = false;
            cancelAnimationFrame(animationId);
            currentTime = 0;
            strobePositions = [];
            startBtn.textContent = '▶ Start';
            message.classList.remove('show');
            document.getElementById('resTime').textContent = '– s';
            document.getElementById('resRange').textContent = '– m';
            document.getElementById('resVx').textContent = v0 + ' m/s';
            document.getElementById('resVy').textContent = '– m/s';
            document.getElementById('resVres').textContent = '– m/s';
            document.getElementById('resAngle').textContent = '– °';
            draw();
        }

        // Events
        heightSlider.addEventListener('input', function() {
            h0 = parseInt(this.value);
            heightVal.textContent = h0 + ' m';
            reset();
        });

        velocitySlider.addEventListener('input', function() {
            v0 = parseInt(this.value);
            velocityVal.textContent = v0 + ' m/s';
            reset();
        });

        startBtn.addEventListener('click', start);
        resetBtn.addEventListener('click', reset);

        [showComparison, showVectors, showStroboscope, showAngle].forEach(cb => {
            cb.addEventListener('change', draw);
        });

        // Init
        draw();
    </script>
</body>
</html>
