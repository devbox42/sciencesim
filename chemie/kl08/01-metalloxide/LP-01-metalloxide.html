<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lernpfad: Reaktion von Metallen mit Sauerstoff</title>
    <style>
/* ═══════════════════════════════════════════════════════════════
   MINT LERNPFAD - Chemie Klasse 8: Metalloxide
   sciencesim Design System - Step-Navigation mit visitedSteps
═══════════════════════════════════════════════════════════════ */

* { box-sizing: border-box; margin: 0; padding: 0; }

:root {
    --bg: #f5f5f5;
    --white: #ffffff;
    --border: #dddddd;
    --text-primary: #222222;
    --text-secondary: #555555;
    --text-muted: #888888;
    --accent: #2a7a4b;
    --accent-light: #e8f5e9;
    --accent-dark: #1e5a35;
    --success: #2a7a4b;
    --success-bg: #e8f5e9;
    --warning: #b35c00;
    --warning-bg: #fff3e0;
    --error: #c62828;
    --error-bg: #ffebee;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg);
    font-size: 16px;
    color: var(--text-primary);
    line-height: 1.5;
}

.container {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
    transition: max-width 0.3s ease;
}

.container.wide-mode {
    max-width: 1100px;
}

/* ═══════════════════════════════════════════════════════════════
   HEADER
═══════════════════════════════════════════════════════════════ */

header {
    background: var(--white);
    border: 1px solid var(--border);
    padding: 15px 20px;
    margin-bottom: 20px;
}

header h1 {
    color: var(--accent);
    font-size: 1.4em;
    font-weight: 600;
}

header .meta {
    color: var(--text-muted);
    font-size: 0.9em;
    margin-top: 5px;
}

.progress-bar {
    background: #e0e0e0;
    height: 8px;
    margin-top: 10px;
}

.progress-fill {
    background: var(--accent);
    height: 100%;
    width: 0%;
    transition: width 0.3s;
}

.step-indicators {
    display: flex;
    gap: 4px;
    margin-top: 10px;
    flex-wrap: wrap;
}

.step-dot {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75em;
    font-weight: 600;
    border: 2px solid var(--border);
    background: var(--white);
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-secondary);
}

.step-dot:hover { border-color: var(--accent); }
.step-dot.completed { background: var(--success); border-color: var(--success); color: var(--white); }
.step-dot.current { border-color: var(--accent); border-width: 3px; color: var(--accent); }

/* ═══════════════════════════════════════════════════════════════
   STEP CONTENT
═══════════════════════════════════════════════════════════════ */

.step {
    background: var(--white);
    border: 1px solid var(--border);
    margin-bottom: 15px;
    display: none;
}

.step.active { display: block; }

.step-header {
    background: var(--accent);
    color: var(--white);
    padding: 12px 15px;
    font-weight: 600;
}

.step-content {
    padding: 20px;
}

/* ═══════════════════════════════════════════════════════════════
   CONTENT BOXES
═══════════════════════════════════════════════════════════════ */

.info-box {
    background: var(--accent-light);
    border: 1px solid var(--accent);
    padding: 12px 15px;
    margin: 15px 0;
}

.info-box strong { color: var(--accent); }

.merke-box {
    background: var(--bg);
    border: 2px solid var(--accent);
    padding: 15px;
    margin: 15px 0;
}

.merke-box::before {
    content: "Merke";
    display: inline-block;
    background: var(--accent);
    color: var(--white);
    font-size: 0.75em;
    font-weight: 600;
    padding: 2px 8px;
    margin-bottom: 8px;
}

.hefter-hinweis {
    background: var(--warning-bg);
    border: 2px solid var(--warning);
    padding: 12px 15px;
    margin: 20px 0;
}

.hefter-hinweis::before {
    content: "Arbeitsblatt";
    display: inline-block;
    background: var(--warning);
    color: var(--white);
    font-size: 0.75em;
    font-weight: 600;
    padding: 2px 8px;
    margin-bottom: 8px;
}

.formula-box {
    background: var(--bg);
    border-left: 4px solid var(--accent);
    padding: 15px;
    margin: 15px 0;
    font-size: 1.1em;
}

/* ═══════════════════════════════════════════════════════════════
   VIDEO & SIMULATION
═══════════════════════════════════════════════════════════════ */

.video-container {
    background: #000;
    aspect-ratio: 16/9;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 15px 0;
    cursor: pointer;
}

.video-container iframe {
    width: 100%;
    height: 100%;
    border: none;
}

.video-placeholder {
    color: white;
    text-align: center;
}

.video-placeholder .play-btn {
    font-size: 3em;
    margin-bottom: 10px;
}

.sim-embed {
    border: 1px solid var(--border);
    margin: 15px 0;
    position: relative;
}

.sim-embed iframe {
    width: 100%;
    height: 550px;
    border: none;
}

.sim-fullscreen-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: var(--accent);
    color: white;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.85em;
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 5px;
}

.sim-fullscreen-btn:hover {
    background: var(--accent-dark);
}

/* Simulation Vollbild-Modus */
.sim-embed.fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    margin: 0;
    z-index: 9999;
    background: var(--bg);
    border: none;
}

.sim-embed.fullscreen iframe {
    height: 100vh;
}

.sim-embed.fullscreen .sim-fullscreen-btn {
    top: 15px;
    right: 15px;
    background: #c62828;
}

.sim-embed.fullscreen .sim-fullscreen-btn:hover {
    background: #a01010;
}

/* ═══════════════════════════════════════════════════════════════
   EXERCISES
═══════════════════════════════════════════════════════════════ */

.exercise {
    background: var(--bg);
    border: 1px solid var(--border);
    padding: 15px;
    margin: 15px 0;
}

.exercise-title {
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 10px;
}

.btn {
    display: inline-block;
    padding: 10px 20px;
    background: var(--accent);
    color: var(--white);
    border: none;
    cursor: pointer;
    font-size: 1em;
    margin: 5px 5px 5px 0;
}

.btn:hover { background: var(--accent-dark); }
.btn-success { background: var(--success); }
.btn-success:hover { background: #1e5a35; }
.btn-secondary { background: #666; }
.btn-secondary:hover { background: #444; }

.nav-buttons {
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid var(--border);
}

.feedback {
    padding: 10px 15px;
    margin: 10px 0;
    display: none;
}

.feedback.correct {
    background: var(--success-bg);
    border: 1px solid var(--success);
    color: #1b5e20;
    display: block;
}

.feedback.incorrect {
    background: var(--error-bg);
    border: 1px solid var(--error);
    color: #b71c1c;
    display: block;
}

/* ═══════════════════════════════════════════════════════════════
   FORM ELEMENTS
═══════════════════════════════════════════════════════════════ */

select, input[type="text"], input[type="number"] {
    padding: 8px;
    font-size: 1em;
    border: 1px solid var(--border);
    margin: 5px 0;
}

select { min-width: 150px; }

.fill-blank {
    border: none;
    border-bottom: 2px solid var(--accent);
    padding: 3px 8px;
    width: 120px;
    background: transparent;
    text-align: center;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin: 15px 0;
}

th, td {
    border: 1px solid var(--border);
    padding: 10px;
    text-align: left;
}

th { background: var(--bg); font-weight: 600; }

ul, ol { margin-left: 20px; margin-top: 10px; }
li { margin: 5px 0; }
.hidden { display: none !important; }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Lernpfad: Reaktion von Metallen mit Sauerstoff</h1>
            <div class="meta">Chemie Klasse 8 | Thema 2.4</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="step-indicators" id="stepIndicators"></div>
        </header>

        <!-- ========== SCHRITT 1: Einstieg ========== -->
        <div class="step active" id="step1">
            <div class="step-header">Schritt 1: Einstieg – Was passiert beim Verbrennen?</div>
            <div class="step-content">
                <div class="info-box">
                    Was passiert, wenn ein Metall brennt? Warum leuchtet eine Wunderkerze so hell? Warum rostet Eisen, aber Aluminium nicht?
                </div>

                <h3 style="margin: 15px 0 10px;">Video: Magnesium verbrennt</h3>
                <div class="video-container" onclick="loadVimeo(this, '699344409')">
                    <div class="video-placeholder">
                        <div class="play-btn">▶</div>
                        <div>Klicken zum Abspielen</div>
                    </div>
                </div>

                <p><strong>Beobachte:</strong> Ein silbriges Metallband (Magnesium) wird angezündet. Es entsteht eine sehr helle, weiße Flamme und ein weißes Pulver.</p>

                <div class="hefter-hinweis">
                    <strong>Aufgabe 4a:</strong> Fülle die Beobachtungstabelle (Vor/Während/Nach/Energie) auf dem Arbeitsblatt aus.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-success" onclick="nextStep(2)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 2: Grundbegriffe ========== -->
        <div class="step" id="step2">
            <div class="step-header">Schritt 2: Grundbegriffe – Oxidation und Oxid</div>
            <div class="step-content">
                <div class="merke-box">
                    <p>Die <strong>Oxidation</strong> ist die chemische Reaktion eines Stoffes mit Sauerstoff.</p>
                    <p>Ein <strong>Oxid</strong> ist eine chemische Verbindung aus einem Element und Sauerstoff.</p>
                </div>

                <h3 style="margin: 15px 0 10px;">Wichtige Unterscheidungen</h3>
                <table>
                    <tr><th>Begriff</th><th>Bedeutung</th><th>Beispiel</th></tr>
                    <tr><td><strong>Element</strong></td><td>Stoff aus nur einer Atomsorte</td><td>Mg, Fe, O₂, Al</td></tr>
                    <tr><td><strong>Verbindung</strong></td><td>Stoff aus verschiedenen Atomsorten in festem Verhältnis</td><td>MgO, H₂O</td></tr>
                    <tr><td><strong>Oxid</strong></td><td>Verbindung mit Sauerstoff</td><td>MgO, Al₂O₃</td></tr>
                </table>

                <div class="hefter-hinweis">
                    <ul style="margin: 0; padding-left: 18px;">
                        <li><strong>Merkkasten:</strong> Übernimm die Definitionen von Oxidation und Oxid.</li>
                        <li><strong>Aufgabe 1:</strong> Ordne die Begriffe zu (nach der Übung unten).</li>
                    </ul>
                </div>

                <div class="exercise">
                    <div class="exercise-title">Übung 1: Begriffe zuordnen</div>
                    <table>
                        <tr>
                            <td><select id="ex1-1" onchange="saveAnswer('ex1-1')">
                                <option value="">-- wählen --</option>
                                <option value="oxidation">Oxidation</option>
                                <option value="element">Element</option>
                                <option value="verbindung">Verbindung</option>
                                <option value="oxid">Oxid</option>
                            </select></td>
                            <td>Reaktion eines Stoffes mit Sauerstoff</td>
                        </tr>
                        <tr>
                            <td><select id="ex1-2" onchange="saveAnswer('ex1-2')">
                                <option value="">-- wählen --</option>
                                <option value="oxidation">Oxidation</option>
                                <option value="element">Element</option>
                                <option value="verbindung">Verbindung</option>
                                <option value="oxid">Oxid</option>
                            </select></td>
                            <td>Stoff aus nur einer Atomsorte</td>
                        </tr>
                        <tr>
                            <td><select id="ex1-3" onchange="saveAnswer('ex1-3')">
                                <option value="">-- wählen --</option>
                                <option value="oxidation">Oxidation</option>
                                <option value="element">Element</option>
                                <option value="verbindung">Verbindung</option>
                                <option value="oxid">Oxid</option>
                            </select></td>
                            <td>Verbindung aus Element und Sauerstoff</td>
                        </tr>
                    </table>
                    <button class="btn" onclick="checkEx1()">Prüfen</button>
                    <div class="feedback" id="feedback1"></div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(1)">← Zurück</button>
                    <button class="btn btn-success" onclick="nextStep(3)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 3: Wortgleichungen ========== -->
        <div class="step" id="step3">
            <div class="step-header">Schritt 3: Wortgleichungen</div>
            <div class="step-content">
                <div class="formula-box">
                    <strong>Schema:</strong> Metall + Sauerstoff → Metalloxid
                </div>

                <h3 style="margin: 15px 0 10px;">Beispiele</h3>
                <ul>
                    <li>Magnesium + Sauerstoff → Magnesiumoxid</li>
                    <li>Eisen + Sauerstoff → Eisenoxid</li>
                    <li>Kupfer + Sauerstoff → Kupferoxid</li>
                    <li>Aluminium + Sauerstoff → Aluminiumoxid</li>
                </ul>

                <div class="hefter-hinweis">
                    <strong>Aufgabe 2:</strong> Ergänze die Wortgleichungen auf dem Arbeitsblatt.
                </div>

                <div class="exercise">
                    <div class="exercise-title">Übung 2: Wortgleichungen ergänzen</div>
                    <p>a) Zink + Sauerstoff → <input type="text" class="fill-blank" id="ex2-1" onchange="saveAnswer('ex2-1')"></p>
                    <p>b) <input type="text" class="fill-blank" id="ex2-2" onchange="saveAnswer('ex2-2')"> + Sauerstoff → Calciumoxid</p>
                    <button class="btn" onclick="checkEx2()">Prüfen</button>
                    <div class="feedback" id="feedback2"></div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(2)">← Zurück</button>
                    <button class="btn btn-success" onclick="nextStep(4)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 4: Formelgleichungen ========== -->
        <div class="step" id="step4">
            <div class="step-header">Schritt 4: Formelgleichungen aufstellen</div>
            <div class="step-content">
                <p>Wortgleichungen zeigen die Reaktion in Worten. <strong>Formelgleichungen</strong> verwenden chemische Symbole und zeigen die genauen Mengenverhältnisse.</p>

                <div class="merke-box">
                    <p>Die <strong>Wertigkeit</strong> gibt an, wie viele Bindungen ein Atom eingehen kann.</p>
                    <table style="margin-top: 10px;">
                        <tr><th>Mg</th><th>Al</th><th>Fe</th><th>Cu</th><th>Zn</th><th>Ca</th><th>O</th></tr>
                        <tr><td>II</td><td>III</td><td>II/III</td><td>I/II</td><td>II</td><td>II</td><td>II</td></tr>
                    </table>
                </div>

                <div class="info-box">
                    <strong>So stellst du eine Formelgleichung auf:</strong>
                    <ol style="margin-left: 15px; margin-top: 8px;">
                        <li><strong>Formel aufstellen:</strong> Mg(II) + O(II) → MgO (1:1)</li>
                        <li><strong>Gleichung schreiben:</strong> Mg + O₂ → MgO (noch nicht ausgeglichen!)</li>
                        <li><strong>Ausgleichen:</strong> <strong>2</strong> Mg + O₂ → <strong>2</strong> MgO ✓</li>
                    </ol>
                </div>

                <div class="exercise">
                    <div class="exercise-title">Übung: Formelgleichung aufstellen</div>
                    <p>Aluminium + Sauerstoff → Aluminiumoxid</p>
                    <p style="margin-top: 10px;">
                        Al hat Wertigkeit <select id="ex3-1" style="width: 60px;" onchange="saveAnswer('ex3-1')">
                            <option value="">--</option>
                            <option value="2">II</option>
                            <option value="3">III</option>
                            <option value="4">IV</option>
                        </select>, O hat Wertigkeit <select id="ex3-2" style="width: 60px;" onchange="saveAnswer('ex3-2')">
                            <option value="">--</option>
                            <option value="2">II</option>
                            <option value="3">III</option>
                            <option value="4">IV</option>
                        </select>
                    </p>
                    <p>Formel des Oxids: Al<sub><input type="text" class="fill-blank" id="ex3-3" style="width: 30px;" onchange="saveAnswer('ex3-3')"></sub>O<sub><input type="text" class="fill-blank" id="ex3-4" style="width: 30px;" onchange="saveAnswer('ex3-4')"></sub></p>
                    <button class="btn" onclick="checkEx3()">Prüfen</button>
                    <div class="feedback" id="feedback3"></div>
                </div>

                <div class="hefter-hinweis">
                    <strong>Aufgabe 3:</strong> Stelle die Formelgleichungen auf dem Arbeitsblatt auf.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(3)">← Zurück</button>
                    <button class="btn btn-success" onclick="nextStep(5)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 5: Simulation ========== -->
        <div class="step has-sim" id="step5">
            <div class="step-header">Schritt 5: Simulation – Oxidation erkunden</div>
            <div class="step-content">
                <p>Beobachte in der Simulation, wie verschiedene Metalle mit Sauerstoff reagieren. Achte auf die <strong>Flammenfarben</strong>!</p>

                <div class="sim-embed" id="simContainer">
                    <button class="sim-fullscreen-btn" onclick="toggleSimFullscreen()">
                        <span id="fsIcon">⛶</span> <span id="fsText">Vollbild</span>
                    </button>
                    <iframe src="SIM-01-oxidation.html" title="Oxidation Simulation"></iframe>
                </div>

                <div class="exercise">
                    <div class="exercise-title">Beobachtungsaufgabe</div>
                    <p>Vergleiche die Reaktionen von <strong>Magnesium</strong> und <strong>Aluminium</strong>:</p>
                    <ul>
                        <li>Welches Metall reagiert vollständig?</li>
                        <li>Warum stoppt die Reaktion bei Aluminium?</li>
                    </ul>
                    <p style="margin-top: 10px;">Aluminium stoppt, weil: <input type="text" class="fill-blank" id="ex5-1" style="width: 200px;" onchange="saveAnswer('ex5-1')"></p>
                    <button class="btn" onclick="checkEx5Sim()">Prüfen</button>
                    <div class="feedback" id="feedback5sim"></div>
                </div>

                <div class="hefter-hinweis">
                    <strong>Aufgabe 4b:</strong> Notiere die Flammenfarben und Oxidfarben der Metalle auf dem Arbeitsblatt.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(4)">← Zurück</button>
                    <button class="btn btn-success" onclick="nextStep(6)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 6: Massenerhaltung ========== -->
        <div class="step" id="step6">
            <div class="step-header">Schritt 6: Gesetz von der Erhaltung der Masse</div>
            <div class="step-content">
                <div class="info-box">
                    <strong>Beobachtung:</strong> Wenn Eisenwolle verbrennt, wird sie schwerer! Warum?
                </div>

                <div class="merke-box">
                    <p><strong>Gesetz von der Erhaltung der Masse:</strong></p>
                    <p>Die Gesamtmasse aller Ausgangsstoffe ist gleich der Gesamtmasse aller Reaktionsprodukte.</p>
                </div>

                <p><strong>Erklärung:</strong> Das Metall reagiert mit Sauerstoff aus der Luft. Die Masse des Sauerstoffs wird zum Metall hinzugefügt. Keine Atome gehen verloren – sie werden nur neu kombiniert.</p>

                <div class="hefter-hinweis">
                    <strong>Aufgabe 5:</strong> Erkläre die Massenerhaltung auf dem Arbeitsblatt.
                </div>

                <div class="exercise">
                    <div class="exercise-title">Übung: Massenerhaltung berechnen</div>
                    <p>12 g Magnesium reagieren mit 8 g Sauerstoff. Wie viel Gramm Magnesiumoxid entstehen?</p>
                    <p>Antwort: <input type="number" class="fill-blank" id="ex6-1" style="width: 80px;" onchange="saveAnswer('ex6-1')"> g</p>
                    <button class="btn" onclick="checkEx6()">Prüfen</button>
                    <div class="feedback" id="feedback6"></div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(5)">← Zurück</button>
                    <button class="btn btn-success" onclick="nextStep(7)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 7: Korrosion ========== -->
        <div class="step" id="step7">
            <div class="step-header">Schritt 7: Korrosion und Oxidschichten</div>
            <div class="step-content">
                <p>Oxidation findet auch langsam statt – das nennen wir <strong>Korrosion</strong>.</p>

                <table>
                    <tr><th>Beispiel</th><th>Beschreibung</th></tr>
                    <tr><td><strong>Rost</strong></td><td>Eisen + Sauerstoff + Wasser → Eisenoxidhydrat (bröckelt ab)</td></tr>
                    <tr><td><strong>Grünspan</strong></td><td>Kupfer oxidiert zu grünem Belag (schützt das Kupfer)</td></tr>
                    <tr><td><strong>Aluminium</strong></td><td>Bildet sofort dünne Oxidschicht (schützt vor weiterer Korrosion)</td></tr>
                </table>

                <p style="margin-top: 15px;"><strong>Warum reagiert Magnesium vollständig, aber Aluminium stoppt?</strong></p>
                <p>Der Unterschied liegt in der <strong>Struktur der Oxidschicht</strong>:</p>

                <table>
                    <tr><th></th><th>Magnesium</th><th>Aluminium</th></tr>
                    <tr><td><strong>Oxidschicht</strong></td><td>porös (durchlässig)</td><td>dicht (undurchlässig)</td></tr>
                    <tr><td><strong>O₂ dringt durch?</strong></td><td>Ja → Reaktion geht weiter</td><td>Nein → Schutz</td></tr>
                    <tr><td><strong>Reaktion stoppt?</strong></td><td>Nein (vollständig)</td><td>Ja (nur Oberfläche)</td></tr>
                    <tr><td><strong>Fachbegriff</strong></td><td>Kettenreaktion</td><td><strong>Passivierung</strong></td></tr>
                </table>

                <div class="info-box">
                    <strong>Passivierung:</strong> Die dichte Oxidschicht von Aluminium blockiert weiteren Sauerstoff. Das Metall ist passiv – es wird geschützt. Deshalb "rostet" Aluminium nicht!
                </div>

                <div class="hefter-hinweis">
                    <strong>Aufgabe 6 + 7:</strong> Beantworte die Fragen zur Korrosion und fülle die Vergleichstabelle (Mg vs. Al) auf dem Arbeitsblatt aus.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(6)">← Zurück</button>
                    <button class="btn btn-success" onclick="nextStep(8)">Weiter →</button>
                </div>
            </div>
        </div>

        <!-- ========== SCHRITT 8: Zusammenfassung ========== -->
        <div class="step" id="step8">
            <div class="step-header">Schritt 8: Zusammenfassung</div>
            <div class="step-content">
                <div class="info-box">
                    <strong>Das hast du gelernt:</strong>
                    <ul>
                        <li><strong>Oxidation</strong> = Reaktion mit Sauerstoff</li>
                        <li>Produkt = <strong>Oxid</strong> (Metalloxid)</li>
                        <li>Energie wird frei (<strong>exotherm</strong>)</li>
                        <li><strong>Massenerhaltung:</strong> Masse(Ausgangsstoffe) = Masse(Produkte)</li>
                        <li>Korrosion = langsame Oxidation im Alltag</li>
                        <li><strong>Passivierung</strong> = schützende Oxidschicht (Al)</li>
                    </ul>
                </div>

                <div class="info-box" style="background: var(--success-bg); border-color: var(--success);">
                    <strong>Geschafft!</strong><br>
                    Du hast den Lernpfad abgeschlossen. Prüfe, ob dein Arbeitsblatt vollständig ist.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="prevStep(7)">← Zurück</button>
                    <button class="btn" onclick="resetProgress()">Fortschritt zurücksetzen</button>
                </div>
            </div>
        </div>
    </div>

    <script>
    // ════════════════════════════════════════════════════════════════
    // LERNPFAD LOGIK (ES5)
    // ════════════════════════════════════════════════════════════════

    var TOTAL_STEPS = 8;
    var STORAGE_KEY = 'lp-chemie-8-metalloxide';

    var currentStep = 1;
    var visitedSteps = [];

    // ───────────────────────────────────────────────────────────────
    // PROGRESS & STEP-INDICATORS
    // ───────────────────────────────────────────────────────────────
    function updateProgress() {
        var percent = ((currentStep - 1) / (TOTAL_STEPS - 1)) * 100;
        document.getElementById('progressFill').style.width = percent + '%';
    }

    function generateStepIndicators() {
        var container = document.getElementById('stepIndicators');
        container.innerHTML = '';
        for (var i = 1; i <= TOTAL_STEPS; i++) {
            var dot = document.createElement('div');
            dot.className = 'step-dot';
            if (i === currentStep) dot.classList.add('current');
            if (visitedSteps.indexOf(i) !== -1) dot.classList.add('completed');
            dot.textContent = i;
            dot.setAttribute('data-step', i);
            dot.onclick = function() {
                var stepIndex = parseInt(this.getAttribute('data-step'));
                showStep(stepIndex);
            };
            container.appendChild(dot);
        }
    }

    function updateStepIndicators() {
        var dots = document.querySelectorAll('.step-dot');
        for (var i = 0; i < dots.length; i++) {
            var stepNum = i + 1;
            dots[i].classList.remove('current');
            if (stepNum === currentStep) {
                dots[i].classList.add('current');
            }
            if (visitedSteps.indexOf(stepNum) !== -1) {
                dots[i].classList.add('completed');
            }
        }
    }

    // ───────────────────────────────────────────────────────────────
    // NAVIGATION
    // ───────────────────────────────────────────────────────────────
    function showStep(n) {
        if (visitedSteps.indexOf(currentStep) === -1) {
            visitedSteps.push(currentStep);
        }

        for (var i = 1; i <= TOTAL_STEPS; i++) {
            var step = document.getElementById('step' + i);
            if (step) step.classList.remove('active');
        }
        var targetStep = document.getElementById('step' + n);
        if (targetStep) {
            targetStep.classList.add('active');
            currentStep = n;
            updateProgress();
            updateStepIndicators();
            saveProgress();
            window.scrollTo(0, 0);

            var container = document.querySelector('.container');
            if (targetStep.classList.contains('has-sim')) {
                container.classList.add('wide-mode');
            } else {
                container.classList.remove('wide-mode');
            }
        }
    }

    function nextStep(n) { showStep(n); }
    function prevStep(n) { showStep(n); }

    // ───────────────────────────────────────────────────────────────
    // VIDEO LOADING
    // ───────────────────────────────────────────────────────────────
    function loadVimeo(container, videoId) {
        container.innerHTML = '<iframe src="https://player.vimeo.com/video/' + videoId + '?h=0&title=0&byline=0&portrait=0" allowfullscreen></iframe>';
    }

    // ───────────────────────────────────────────────────────────────
    // SIMULATION VOLLBILD
    // ───────────────────────────────────────────────────────────────
    function toggleSimFullscreen() {
        var container = document.getElementById('simContainer');
        var icon = document.getElementById('fsIcon');
        var text = document.getElementById('fsText');

        if (container.classList.contains('fullscreen')) {
            container.classList.remove('fullscreen');
            icon.textContent = '⛶';
            text.textContent = 'Vollbild';
            document.body.style.overflow = '';
        } else {
            container.classList.add('fullscreen');
            icon.textContent = '✕';
            text.textContent = 'Schließen';
            document.body.style.overflow = 'hidden';
        }
    }

    // ESC-Taste zum Beenden des Vollbilds
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            var container = document.getElementById('simContainer');
            if (container && container.classList.contains('fullscreen')) {
                toggleSimFullscreen();
            }
        }
    });

    // ───────────────────────────────────────────────────────────────
    // ÜBUNGEN PRÜFEN
    // ───────────────────────────────────────────────────────────────
    function checkEx1() {
        var correct = { 'ex1-1': 'oxidation', 'ex1-2': 'element', 'ex1-3': 'oxid' };
        var points = 0;
        for (var id in correct) {
            if (document.getElementById(id).value === correct[id]) points++;
        }
        var fb = document.getElementById('feedback1');
        if (points === 3) {
            fb.className = 'feedback correct';
            fb.textContent = '✓ Richtig! Alle Zuordnungen stimmen.';
        } else {
            fb.className = 'feedback incorrect';
            fb.textContent = '✗ ' + points + '/3 richtig. Schau nochmal in die Tabelle oben.';
        }
    }

    function checkEx2() {
        var ans1 = document.getElementById('ex2-1').value.toLowerCase().trim();
        var ans2 = document.getElementById('ex2-2').value.toLowerCase().trim();
        var c1 = ans1 === 'zinkoxid' || ans1 === 'zno';
        var c2 = ans2 === 'calcium' || ans2 === 'kalzium' || ans2 === 'ca';
        var fb = document.getElementById('feedback2');
        if (c1 && c2) {
            fb.className = 'feedback correct';
            fb.textContent = '✓ Richtig! Zink + Sauerstoff → Zinkoxid; Calcium + Sauerstoff → Calciumoxid';
        } else {
            fb.className = 'feedback incorrect';
            fb.textContent = '✗ Nicht ganz. Lösungen: a) Zinkoxid, b) Calcium';
        }
    }

    function checkEx3() {
        var w1 = document.getElementById('ex3-1').value;
        var w2 = document.getElementById('ex3-2').value;
        var idx1 = document.getElementById('ex3-3').value.trim();
        var idx2 = document.getElementById('ex3-4').value.trim();
        var fb = document.getElementById('feedback3');
        var correct = w1 === '3' && w2 === '2' && idx1 === '2' && idx2 === '3';
        if (correct) {
            fb.className = 'feedback correct';
            fb.textContent = '✓ Richtig! Al hat Wertigkeit III, O hat II → Al₂O₃';
        } else {
            fb.className = 'feedback incorrect';
            fb.textContent = '✗ Tipp: Al(III), O(II). Kreuzregel: Al₂O₃';
        }
    }

    function checkEx5Sim() {
        var ans = document.getElementById('ex5-1').value.toLowerCase();
        var fb = document.getElementById('feedback5sim');
        if (ans.indexOf('passiv') !== -1 || ans.indexOf('schicht') !== -1 || ans.indexOf('dicht') !== -1 || ans.indexOf('schütz') !== -1) {
            fb.className = 'feedback correct';
            fb.textContent = '✓ Richtig! Die dichte Al₂O₃-Schicht blockiert weiteren Sauerstoff (Passivierung).';
        } else {
            fb.className = 'feedback incorrect';
            fb.textContent = '✗ Tipp: Es hat mit der Oxidschicht zu tun. Stichwort: Passivierung.';
        }
    }

    function checkEx6() {
        var val = parseFloat(document.getElementById('ex6-1').value.replace(',', '.'));
        var fb = document.getElementById('feedback6');
        if (Math.abs(val - 20) < 0.5) {
            fb.className = 'feedback correct';
            fb.textContent = '✓ Richtig! 12 g + 8 g = 20 g (Massenerhaltung!)';
        } else {
            fb.className = 'feedback incorrect';
            fb.textContent = '✗ Nicht ganz. Tipp: Addiere die Massen. Lösung: 12 + 8 = 20 g';
        }
    }

    // ───────────────────────────────────────────────────────────────
    // PERSISTENZ
    // ───────────────────────────────────────────────────────────────
    function saveProgress() {
        try {
            localStorage.setItem(STORAGE_KEY + '-step', currentStep);
            localStorage.setItem(STORAGE_KEY + '-visited', JSON.stringify(visitedSteps));
            var inputs = document.querySelectorAll('input, select');
            for (var i = 0; i < inputs.length; i++) {
                var el = inputs[i];
                if (el.id) {
                    localStorage.setItem(STORAGE_KEY + '-' + el.id, el.value);
                }
            }
        } catch (e) {}
    }

    function saveAnswer(id) {
        saveProgress();
    }

    function loadProgress() {
        try {
            var savedVisited = localStorage.getItem(STORAGE_KEY + '-visited');
            if (savedVisited) visitedSteps = JSON.parse(savedVisited);
            var savedStep = localStorage.getItem(STORAGE_KEY + '-step');
            if (savedStep) currentStep = parseInt(savedStep);
            var inputs = document.querySelectorAll('input, select');
            for (var i = 0; i < inputs.length; i++) {
                var el = inputs[i];
                if (el.id) {
                    var saved = localStorage.getItem(STORAGE_KEY + '-' + el.id);
                    if (saved) el.value = saved;
                }
            }
        } catch (e) {}
    }

    function resetProgress() {
        if (!confirm('Fortschritt wirklich zurücksetzen?')) return;
        try {
            var keys = [];
            for (var i = 0; i < localStorage.length; i++) {
                if (localStorage.key(i).indexOf(STORAGE_KEY) === 0) {
                    keys.push(localStorage.key(i));
                }
            }
            for (var j = 0; j < keys.length; j++) {
                localStorage.removeItem(keys[j]);
            }
        } catch (e) {}
        location.reload();
    }

    document.addEventListener('change', saveProgress);

    // ───────────────────────────────────────────────────────────────
    // INIT
    // ───────────────────────────────────────────────────────────────
    loadProgress();
    generateStepIndicators();
    updateProgress();

    if (currentStep > 1) {
        for (var i = 1; i <= TOTAL_STEPS; i++) {
            var step = document.getElementById('step' + i);
            if (step) step.classList.remove('active');
        }
        var targetStep = document.getElementById('step' + currentStep);
        if (targetStep) {
            targetStep.classList.add('active');
            updateStepIndicators();
            var container = document.querySelector('.container');
            if (targetStep.classList.contains('has-sim')) {
                container.classList.add('wide-mode');
            }
        }
    }
    </script>
</body>
</html>
